[
  {
    "text": "<s>[INST] <<SYS>>\nYou are a helpful cybersecurity assistant that generates detailed incident response playbooks based on NIST guidelines.\n<</SYS>>\n\nPlease generate a playbook for a Phishing attack.\n[/INST] \n\n## Playbook: Phishing\n\n### MITRE\n\n| Tactic | Technique ID | Technique Name | Sub-Technique Name | Platforms | Permissions Required |\n| ------ | ------------ | -------------- | ------------------ |---------- |--------------------- |\n|Initial Access|T1566|Phishing|                      |Google Workspace, Linux, Office 365, SaaS, Windows, macOS||\n\n\n**Investigate, remediate (contain, eradicate), and communicate in parallel!**\n\nAssign steps to individuals or teams to work concurrently, when possible; this playbook is not purely sequential. Use your best judgment.\n\n### Investigate\n\n1. **Scope the attack** Usually you will be notified that a potential phishing attack is underway, either by a user, customer, or partner.\n    * Determine **total number of impacted users**\n    * Understand **user actions** in response to the phishing email (_e.g._, did they download the attachment, visit the spoofed site, or give out any personal or business informatio n such as credentials)\n    * Find the potentially related activity. Check:\n        * social media\n        * any possibly suspicious emails\n        * emails with links to external and unknown URLs\n        * non-returnable or non-deliverable emails\n        * any kind of notification of suspicious activity\n1. **Analyze the message** using a safe device (i.e., **do not** open messages on a device with access to sensitive data or credentials as the message may contain malware), determine: `TODO: Specify tools and procedure`\n    * who received the message\n    * who was targeted by the message (may be different than \"successful\" recipients)\n    * email address of the sender\n    * subject line\n    * message body\n    * attachments (**do not open attachments** except according to established procedures)\n    * links, domains, and hostnames (**do not follow links** except according to established procedures)\n    * email metadata including message headers (see below)\n        * sender information from the 'from' field and the X-authenticated user header\n        * all client and mail server IP addresses\n    * note \"quirks\" or suspicious features\n1. **Analyze links and attachments** `TODO: Specify tools and procedure`\n    * use passive collection such as nslookup and whois to find IP addresses and registration information\n    * find related domains using OSINT (_e.g._, [reverse whois](https://www.whoxy.com/reverse-whois/)) on email addresses and other registration data\n    * submit links, attachments, and/or hashes to [VirusTotal](https://www.virustotal.com/gui/)\n    * submit links, attachments, and/or hashes to a malware sandbox such as [Cuckoo](https://cuckoosandbox.org/), [Hybrid Analysis](https://www.hybrid-analysis.com/), [Joe Sandbox](https://www.joesecurity.org/), or [VMray](https://www.vmray.com/).\n1. Categorize the type of attack. `TODO: Customize categories and create additional playbooks for common or high-impact phishing types`\n1. **Determine the severity.** Consider:\n    * whether public or personal safety is at risk\n    * whether personal data (or other sensitive data) is at risk\n    * any evidence of who is behind the attack\n    * number of affected assets\n    * preliminary business impact\n    * whether services are affected\n    * whether you are able to control/record critical systems\n\n\n### Remediate\n\n* **Plan remediation events** where these steps are launched together (or in coordinated fashion), with appropriate teams ready to respond to any disruption.\n* **Consider the timing and tradeoffs** of remediation actions: your response has consequences.\n\n#### Contain\n\n\n* Contain affected accounts\n    * change login credentials\n    * reduce access to critical services, systems, or data until investigation is complete\n    * reenforce multi-factor authentication (MFA)\n* Block activity based on discovered indicators of compromise, _e.g._:\n    * block malicious domains using DNS, firewalls, or proxies\n    * block messages with similar senders, message bodies, subjects, links, attachments, _etc._, using email gateway or service.\n* Implement forensic hold or retain forensic copies of messages\n* Purge related messages from other user inboxes, or otherwise make inaccessible\n* Contain broader compromise in accordance with general IR plan\n* Consider mobile device containment measures such as wiping via mobile device management (MDM).  Balance against investigative/forensic impact.\n* Increase detection \"alert level,\" with enhanced monitoring, particularly from related accounts, domains, or IP addresses.\n* Consider outside security assistance to support investigation and remediation\n* Confirm relevant software upgrades and anti-malware updates on assets.\n\n#### Reference: Remediation Resources\n\n`TODO: Specify financial, personnel, and logistical resources to accomplish remediation`\n\n### Communicate\n\n\n1. Escalate incident and communicate with leadership per procedure\n1. Document incident per procedure (and [report](https://us-cert.cisa.gov/report-phishing))\n1. Communicate with internal and external legal counsel per procedure, including discussions of compliance, risk exposure, liability, law enforcement contact, _etc._\n1. Communicate with users (internal)\n    1. Communicate incident response updates per procedure\n    1. Communicate impact of incident **and** incident response actions (e.g., containment: \"why is the file share down?\")\n    1. Communicate requirements: \"what should users do and not do?\"\n1. Communicate with customers\n    1. Focus particularly on those whose data was affected\n    1. Generate required notifications based on applicable regulations (particularly those that may consider phishing a data breach or otherwise requires notifications) `TODO: Expand notification requirements and procedures for applicable regulations`\n1. Contact insurance provider(s)\n    1. Discuss what resources they can make available, what tools and vendors they support and will pay for, _etc._\n    1. Comply with reporting and claims requirements to protect eligibility\n1. Consider notifying and involving [law enforcement](https://www.usa.gov/stop-scams-frauds) TODO: Link the following bullets to actual resources for your organization\n    1. [Local law enforcement](#TODO-link-to-actual-resource)\n    1. [State or regional law enforcement](#TODO-link-to-actual-resource)\n    1. [Federal or national law enforcement](#TODO-link-to-actual-resource)\n1. Communicate with security and IT vendors TODO: Link the following bullets to actual resources for your organization\n    1. Notify and collaborate with [managed providers](#TODO-link-to-actual-resource) per procedure\n    1. Notify and collaborate with [incident response consultants](#TODO-link-to-actual-resource) per procedure\n\n### Recover\n\n\n1. Launch business continuity/disaster recovery plan(s) if compromise involved business outages: _e.g._, consider migration to alternate operating locations, fail-over sites, backup systems.\n1. Reinforce training programs regarding suspected phishing attacks. Key suspicious indicators may include: \n    * misspellings in the message or subject\n    * phony-seeming sender names, including mismatches between display name and email address\n    * personal email addresses for official business (e.g., gmail or yahoo emails from business colleagues)\n    * subject lines marked \"[EXTERNAL]\" on emails that look internal\n    * [malicious or suspicious links](https://www.pcworld.com/article/248963/how-to-tell-if-a-link-is-safe-without-clicking-on-it.html)\n    * receiving an email or attachment they were not expecting but from someone they know (contact sender before opening it)\n    * reporting suspicious activity to IT or security\n1. Ensure that IT and security staff is up to date on recent phishing techniques.\n1. Determine if any controls have failed when falling victim to an attack and rectify them. Here is a [good source](https://www.proofpoint.com/us/security-awareness/post/14-things-do-after-phishing-attack) to consider following a phishing attack.\n\n### Resources\n\n#### Reference: User Actions for Suspected Phishing Attack\n\n1. Stay calm, take a deep breath.\n1. Take pictures of your screen using your smartphone showing the things you noticed: the phishing message, the link if you opened it, the sender information.\n1. Take notes about the problem(s) using the voice memo app on your smartphone or pen-and-paper.  Every little bit helps!  Document the following:\n    1. What did you notice?\n    1. Why did you think it was a problem?\n    1. What were you doing at the time you detected it?\n    1. When did it first occur, and how often since?\n    1. Where were you when it happened, and on what network? (office/home/shop, wired/wireless, with/without VPN, _etc._)\n    1. What systems are you using? (operating system, hostname, _etc._)\n    1. What account were you using?\n    1. What data do you typically access?\n    1. Who else have you contacted about this incident, and what did you tell them?\n1. Contact the [help desk](#TODO-link-to-actual-resource) using the [phishing hotline](#TODO-link-to-actual-resource) or the [phishing report toolbar](#TODO-link-to-actual-resource) and be as helpful as possible.\n1. Be patient: the response may be disruptive, but you are protecting your team and the organization!  **Thank you.**\n\n#### Reference: Help Desk Actions for Suspected Phishing Attack\n\n\n1. Stay calm, take a deep breath.\n1. Open a ticket to document the incident, per procedure. `TODO: Customize template with key questions (see below) and follow-on workflow`\n1. Ask the user to take pictures of their screen using their smartphone showing the things they noticed: the phishing message, the link if you opened it, the sender information, _etc._  If this is something you noticed directly, do the same yourself.\n1. Take notes about the problem(s) using the voice memo app on your smartphone or pen-and-paper.  If this is a user report, ask detailed questions, including:\n    1. What did you notice?\n    1. Why did you think it was a problem?\n    1. What were you doing at the time you detected it?\n    1. When did it first occur, and how often since?\n    1. What networks are involved? (office/home/shop, wired/wireless, with/without VPN, _etc._)\n    1. What systems are involved? (operating system, hostname, _etc._)\n    1. What data is involved? (paths, file types, file shares, databases, software, _etc._)\n    1. What users and accounts are involved? (active directory, SaaS, SSO, service accounts, _etc._)\n    1. What data do the involved users typically access?\n    1. Who else have you contacted about this incident, and what did you tell them?\n1. Ask follow-up questions as necessary.  **You are an incident responder, we are counting on you.**\n1. Get detailed contact information from the user (home, office, mobile), if applicable.\n1. Record all information in the ticket, including hand-written and voice notes.\n1. Quarantine affected users and systems. `TODO: Customize containment steps, automate as much as possible`\n1. Contact the [security team](#TODO-link-to-actual-resource) and stand by to participate in the response as directed: investigation, remediation, communication, and recovery.\n\n#### Additional Information\n\n1. <a name=\"phishing-playbook-ref-1\"></a>[Anti-Phishing Attack resources](https://resources.infosecinstitute.com/category/enterprise/phishing/phishing-countermeasures/top-16-anti-phishing-resources/#gref)\n1. <a name=\"phisphing-playbook-ref-2\"></a>[Methods of Identifying a Phishing attack](https://www.securitymetrics.com/blog/7-ways-recognize-phishing-email)\n1. <a name=\"phishing-playbook-ref-3\"></a>[Phishing Email Examples](https://www.phishing.org/phishing-examples)\n1. <a name=\"phishing-playbook-ref-4\"></a>[Anti-Phishing best practices](https://resources.infosecinstitute.com/category/enterprise/phishing/phishing-countermeasures/anti-phishing-best-practices/#gref)\n\n</s>"
  },
  {
    "text": "<s>[INST] <<SYS>>\nYou are a helpful cybersecurity assistant that generates detailed incident response playbooks based on NIST guidelines.\n<</SYS>>\n\nPlease generate a playbook for a Spearphishing Attachment attack (T1566.001).\n[/INST] \n\n## Sub-technique Playbook: T1566.001 - Spearphishing Attachment\n\n### MITRE\n\n| Tactic | Technique ID | Technique Name | Sub-Technique Name | Platforms | Permissions Required |\n| ------ | ------------ | -------------- | ------------------ |---------- |--------------------- |\n|        |              |                |                    |           |                      |\n\n\n```\n(P) Preparation\n  \n \n```\n  \nAssign steps to individuals or teams to work concurrently, when possible; this playbook is not purely sequential. Use your best judgment.\n\n\n\n### Investigate\n\n`TODO: Expand investigation steps, including key questions and strategies, for <Type of Incident>.`\n\n\n\n\n\n### Remediate\n\n* **Plan remediation events** where these steps are launched together (or in coordinated fashion), with appropriate teams ready to respond to any disruption.\n* **Consider the timing and tradeoffs** of remediation actions: your response has consequences.\n\n#### Contain\n\n`TODO: Customize containment steps, tactical and strategic, for <Type of Incident>.`\n\n`TODO: Specify tools and procedures for each step, below.`\n\n\n\n`TODO: Consider automating containment measures using orchestration tools.`\n\n#### Eradicate\n\n`TODO: Customize eradication steps, tactical and strategic, for <Type of Incident>.`\n\n`TODO: Specify tools and procedures for each step, below.`\n\n\n\n#### Reference: Remediation Resources\n\n`TODO: Specify financial, personnel, and logistical resources to accomplish remediation.`\n\n\n\n### Communicate\n\n`TODO: Customize communication steps for <Type of Incident>`\n\n`TODO: Specify tools and procedures (including who must be involved) for each step, below, or refer to overall plan.`\n\nIn addition to the general steps and guidance in the incident response plan:\n\n\n  \n  \n\n\n\n### Recover\n\n`TODO: Customize recovery steps for <Type of Incident>.`\n\n`TODO: Specify tools and procedures for each step, below.`\n\nIn addition to the general steps and guidance in the incident response plan:\n\n\n\n  \n### Lessons Learned\n\n`TODO: Add items that will occur post recover.`\n  \n1.    Perform routine cyber hygiene due diligence\n2.    Engage external cybersecurity-as-a-service providers and response professionals\n  \n\n\n\n### Resources\n\n#### Additional Information\n\n1. <a name=\"identity-and-access-playbook-ref-1\"></a>[\"Title\"](#TODO-url), Author Last Name (Date)\n\n</s>"
  },
  {
    "text": "<s>[INST] <<SYS>>\nYou are a helpful cybersecurity assistant that generates detailed incident response playbooks based on NIST guidelines.\n<</SYS>>\n\nPlease generate a playbook for a Spearphishing Link attack (T1566.002).\n[/INST] \n\n## Sub-technique Playbook: T1566.002 - Spearphishing Link\n\n### MITRE\n\n| Tactic | Technique ID | Technique Name | Sub-Technique Name | Platforms | Permissions Required |\n| ------ | ------------ | -------------- | ------------------ |---------- |--------------------- |\n|        |              |                |                    |           |                      |\n\n\n```\n(P) Preparation\n  \n \n```\n  \nAssign steps to individuals or teams to work concurrently, when possible; this playbook is not purely sequential. Use your best judgment.\n\n\n\n### Investigate\n\n`TODO: Expand investigation steps, including key questions and strategies, for <Type of Incident>.`\n\n\n\n\n\n\n### Remediate\n\n* **Plan remediation events** where these steps are launched together (or in coordinated fashion), with appropriate teams ready to respond to any disruption.\n* **Consider the timing and tradeoffs** of remediation actions: your response has consequences.\n\n#### Contain\n\n`TODO: Customize containment steps, tactical and strategic, for <Type of Incident>.`\n\n`TODO: Specify tools and procedures for each step, below.`\n\n\n\n`TODO: Consider automating containment measures using orchestration tools.`\n\n#### Eradicate\n\n`TODO: Customize eradication steps, tactical and strategic, for <Type of Incident>.`\n\n`TODO: Specify tools and procedures for each step, below.`\n\n\n\n#### Reference: Remediation Resources\n\n`TODO: Specify financial, personnel, and logistical resources to accomplish remediation.`\n\n\n\n### Communicate\n\n`TODO: Customize communication steps for <Type of Incident>`\n\n`TODO: Specify tools and procedures (including who must be involved) for each step, below, or refer to overall plan.`\n\nIn addition to the general steps and guidance in the incident response plan:\n\n\n  \n  \n\n### Recover\n\n`TODO: Customize recovery steps for <Type of Incident>.`\n\n`TODO: Specify tools and procedures for each step, below.`\n\nIn addition to the general steps and guidance in the incident response plan:\n\n\n\n  \n### Lessons Learned\n\n`TODO: Add items that will occur post recover.`\n  \n1.    Perform routine cyber hygiene due diligence\n2.    Engage external cybersecurity-as-a-service providers and response professionals\n  \n\n\n\n### Resources\n\n#### Additional Information\n\n1. <a name=\"identity-and-access-playbook-ref-1\"></a>[\"Title\"](#TODO-url), Author Last Name (Date)\n\n</s>"
  },
  {
    "text": "<s>[INST] <<SYS>>\nYou are a helpful cybersecurity assistant that generates detailed incident response playbooks based on NIST guidelines.\n<</SYS>>\n\nPlease generate a playbook for a Spearphishing via Service attack (T1566.003).\n[/INST] \n\n## Playbook: Sub-technique T1566.003 - Spearphishing via Service\n\n### MITRE\n\n| Tactic | Technique ID | Technique Name | Sub-Technique Name | Platforms | Permissions Required |\n| ------ | ------------ | -------------- | ------------------ |---------- |--------------------- |\n|        |              |                |                    |           |                      |\n\n\n```\n(P) Preparation\n  \n \n```\n  \nAssign steps to individuals or teams to work concurrently, when possible; this playbook is not purely sequential. Use your best judgment.\n\n\n\n### Investigate\n\n`TODO: Expand investigation steps, including key questions and strategies, for <Type of Incident>.`\n\n\n\n\n\n### Remediate\n\n* **Plan remediation events** where these steps are launched together (or in coordinated fashion), with appropriate teams ready to respond to any disruption.\n* **Consider the timing and tradeoffs** of remediation actions: your response has consequences.\n\n#### Contain\n\n`TODO: Customize containment steps, tactical and strategic, for <Type of Incident>.`\n\n`TODO: Specify tools and procedures for each step, below.`\n\n\n\n`TODO: Consider automating containment measures using orchestration tools.`\n\n#### Eradicate\n\n`TODO: Customize eradication steps, tactical and strategic, for <Type of Incident>.`\n\n`TODO: Specify tools and procedures for each step, below.`\n\n\n\n#### Reference: Remediation Resources\n\n`TODO: Specify financial, personnel, and logistical resources to accomplish remediation.`\n\n--------------\n\n### Communicate\n\n`TODO: Customize communication steps for <Type of Incident>`\n\n`TODO: Specify tools and procedures (including who must be involved) for each step, below, or refer to overall plan.`\n\nIn addition to the general steps and guidance in the incident response plan:\n\n\n  \n  \n\n--------------\n\n### Recover\n\n`TODO: Customize recovery steps for <Type of Incident>.`\n\n`TODO: Specify tools and procedures for each step, below.`\n\nIn addition to the general steps and guidance in the incident response plan:\n\n\n--------------\n  \n### Lessons Learned\n\n`TODO: Add items that will occur post recover.`\n  \n1.    Perform routine cyber hygiene due to diligence\n2.    Engage external cybersecurity-as-a-service providers and response professionals\n  \n\n--------------\n\n### Resources\n\n#### Additional Information\n\n1. <a name=\"identity-and-access-playbook-ref-1\"></a>[\"Title\"](#TODO-url), Author Last Name (Date)\n\n</s>"
  }
]
[
  {
    "text": "<s>[INST] <<SYS>>\nYou are a helpful cybersecurity assistant that generates detailed incident response playbooks, particularly for cloud environments like AWS, based on NIST guidelines.\n<</SYS>>\n\nPlease generate a playbook for a Web Application DoS/DDoS Attack, considering AWS services and best practices.\n[/INST] \n\n# Incident Response Playbook Template\n\n### Incident Type\n\nWeb Application Dos/DDoS Attack\n\n### Introduction\n\nThis playbook is provided as a template to customers using AWS products and who are building their incident response capability. You should customize this template playbook to suit your particular needs, risks, available tools and work processes.\n\nSecurity and Compliance is a shared responsibility between you and AWS. AWS is responsible for “Security of the Cloud”, while you are responsible for “Security in the Cloud”. For more information on the shared responsibility model, [please review our documentation](https://aws.amazon.com/compliance/shared-responsibility-model/).\n\nYou are responsible for making your own independent assessment of the information in this document. This document: (a) is for informational purposes only, (b) references current AWS product offerings and practices, which are subject to change without notice, and (c) does not create any commitments or assurances from AWS and its affiliates, suppliers or licensors. This document is provided “as is” without warranties, representations, or conditions of any kind, whether express or implied. The responsibilities and liabilities of AWS to its customers are controlled by AWS agreements, and this document is not part of, nor does it modify, any agreement between AWS and its customers.\n\n## Summary\n\n### This Playbook\nThis playbook outlines response steps for Web Application Dos/DDoS Attack incidents. These steps are based on the [NIST Computer Security Incident Handling Guide](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf) (Special Publication 800-61 Revision 2) that can be used to:\n\n* Gather evidence\n* Contain and then eradicate the incident\n* recover from the incident\n* Conduct post-incident activities, including post-mortem and feedback processes\n\nInterested readers may also refer to the [AWS Security Incident Response Guide](https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/welcome.html) which contains additional resources.\n\nOnce you have customized this playbook to meet your needs, it is important that you test the playbook (e.g., Game Days) and any automation (functional tests), update as necessary to achieve the desired results, and then publish to your knowledge management system and train all responders.\n\nNote that some of the incident response steps noted in each scenario may incur costs in your AWS account(s) for services used in either preparing for, or responding to incidents. Customizing these scenarios and testing them will help you to determine if additional costs will be incurred. You can use [AWS Cost Explorer](https://aws.amazon.com/aws-cost-management/aws-cost-explorer/) and look at costs incurred over a particular time frame (such as when running Game Days) to establish what the possible impact might be.\n\nIn reviewing this playbook, you will find steps that involve processes that you may not have in place today. Proactively preparing for incidents means you need the right resource configurations, tools and services in place that allow you to respond to an incident.\n\nThe next section will provide a summary of this incident type, and then cover the five steps (parts 1 - 5) for handling DoS and DDoS attacks.\n\n### This Incident Type\nDoS and DDoS attacks are “denial of service” attacks, designed to prevent legitimate users from accessing your web applications. They target different layers of the OSI model and often exploit protocol weaknesses. Other attacks may simply use legitimate requests to your web application, but increase the volume of those requests to a point where your web application is overwhelmed and no longer able to service legitimate requests. When you use AWS services, you benefit from protections built in to those services. Additionally, if you follow the [AWS Best Practices for DDoS Resiliency](https://docs.aws.amazon.com/whitepapers/latest/aws-best-practices-ddos-resiliency/aws-best-practices-ddos-resiliency.pdf), you will increase the availability of your application and its ability to withstand DDoS attacks.\n\n## Incident Response Process\n---\n### Part 1: Acquire, Preserve, Document Evidence\n\n1. You become aware that your application is not meeting availability requirements. This may mean that the application is unavailable, is providing a degraded service, or even appears to be functioning, but application performance metrics or logging are suggesting that there may be an issue. This information could come via different means, for example:\n    - Customer contact/feedback/support calls\n    - An internal ticketing system (the sources of the ticket are varied and could include any of the means below)\n    - A message from a contractor or third-party service provider\n    - From an alert in one of your own monitoring systems either internal or external to AWS (for example, in AWS, in this particular situation, it could be via CloudWatch metrics triggering an alarm from Amazon EC2, AWS Application Load Balancer, Amazon CloudFront, AWS WAF or other services that you have configured CloudWatch alarms for)\n    - Via an anonymous tip\n    - Via independent or external security researchers\n2. Confirm an internal ticket/case has been raised for the incident within your organization. If not, manually raise one.\n3. Determine and begin to document end-user impact/experience of the issue. This should be documented in the ticket/case related to the incident\n4. In the case of automatically created tickets/cases, determine what internal alarms/metrics are currently indicating an issue (what caused the ticket to be created?)\n5. Determine the application impacted (this may be done quickly via Resource Tags)\n6. Determine if there are any known events that could be causing disruption to your application (increased traffic due to a sales event, or similar)\n7. Check your Configuration Management Database (CMDB) to determine if there were any deployments to your production environment (code, software or infrastructure updates) that may result in an increase in traffic to the affected URL(s)\n8. Incident Communications:\n    1. Identify stakeholder roles from the application entry in the CMDB entry for that application, or via the application’s risk register\n    2. Open a conference bridge war room for the incident\n    3. Notify identified stakeholders including (if required) legal personnel, public relations, technical teams and developers and add them to the ticket and the war room, so they are updated as the ticket is updated\n9. External Communications:\n    1. Ensure your organizations legal counsel is informed and is included in status updates to internal stakeholders and especially in regards to external communications.\n    2. For colleagues in the organization that are responsible for providing public/external communication statements, ensure these internal stakeholders are added to the ticket so they receive regular status updates regarding the incident and can complete their own requirements for communications within and external to the business.\n    3. If there are regulations in your jurisdiction requiring reporting of such incidents, ensure the people in your organization responsible for notifying local or federal law enforcement agencies are also notified of the event/added to the ticket. Consult your legal advisor and/or law enforcement for guidance on collecting and preserving the evidence and chain of custody.\n    4. There may not be regulations, but either open databases, government agencies or NGOs may track this type of activity. Your reporting may assist others\n10. Determine the resources involved in serving the application (start with front-end resources, including CDNs, load balancers and front-end application servers, then move to supporting services, such as databases, caches, etc.)\n11. Obtain the application’s documented baseline and locate the metrics for standard application performance from the CMDB.\n12. Determine if the application’s resources are currently displaying metrics outside the baseline:\n    1. For Amazon CloudFront, check the following metrics:\n        1. Confirm if there is a significant variation in:\n            1. [Data transferred](https://aws.amazon.com/cloudfront/reporting/) over HTTP and/or HTTPS\n            2. [Total number](https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/monitoring-using-cloudwatch.html) of HTTP requests\n        2. If monitoring CloudFront access logs, determine if there has been a spike in 4xx or 5xx HTTP return codes (in Amazon CloudWatch, All >> CloudFront >> Per-Distribution Metrics) with a Metric Name of 5xxErrorRate or 4xxErrorRate\n    2. For Application Load Balancers, [check the following metrics](https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-cloudwatch-metrics.html), which may give further information on the type of attack, and how it is impacting your application:\n        1. Confirm if there is a significant variation in:\n            1. HTTPCode_ELB_4xx_Count (indicators of attacks that may involve credential stuffing, malformed or incomplete requests, or overly aggressive website scraping, etc.)\n            2. HTTPCode_ELB_2xx_Count (a dramatic increase may indicate a HTTP flood attack)\n            3. ActiveConnectionCount (indicates total concurrent TCP connections to ALB, when used with SUM)\n            4. ClientTLSNegotiationErrorCount (this may indicate a protocol exploitation attack by abusing the SSL handshake process, such as sending only weak ciphers in a request)\n            5. RequestCount (a significant increase in requests may indicate a HTTP flood attack)\n            6. HTTPCode_Target_5XX_Count (as this is a response dedicated by a host or container behind the load balancer, this may indicate that the server is unable to respond to the number of received requests, this may also be the result of impacted services downstream, such as a supporting database)\n            7. TargetResponseTime (increasing response times may indicate server resources are not available to serve requests from the load balancer)\n            8. ELBAuthFailure (indicates that user authentication could not be completed, as the IdP denied access to the user, or a user attempted to replay an already used auth token)\n        2. Note the metrics of concern\n    3. For Amazon Elastic Compute Cloud (Amazon EC2) instances, check the [following metrics](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/monitoring_ec2.html):\n        1. Confirm if there is significant variation in:\n            1. CPU utilization\n            2. Network utilization\n            3. Disk performance\n            4. Memory utilization (if using the [CloudWatch Logs Agent](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Install-CloudWatch-Agent.html))\n        2. Note the metrics of concern\n13. Obtain logs relevant to the incident (these will be the logs from the resources identified above, in point 4), these should include the following (note that these logs should be already configured to be sent to CloudWatch Logs):\n    1. Web server access logs\n        1. RHEL-based - /var/log/apache/access.log, or\n        2. Debian-based - /var/log/apache2/access.log\n    2. Load balancer logs:\n        1. Application Load Balancer Logs will be configured for the ALB and [sent to an Amazon Simple Storage Service (Amazon S3) bucket](https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-access-logs.html). If you are not sure which bucket the logs are being sent to, [use this document to help you determine the bucket name](https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-access-logs.html#enable-access-logging).\n    3. CloudFront Distribution logs. CloudFront will be configured to [send its access logs to an S3 bucket](https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html).\n14. Once you have verified you have access to the logs, use your preferred tool (for example, Amazon Athena, internal, or third-party tools) to review the logs and determine if there are any identifiable attack signatures. Such signatures may be the following:\n    1. An unusual number of requests within a given time period\n    2. An unusual set of source IPs\n    3. A set of unrecognized URLs in the request section\n    4. POST or Query parameters that are not expected or supported by the application\n    5. Unexpected HTTP verbs (GET, where we expect POST, etc)\n    6. An unusually high number of 2xx, 4xx or 5xx responses\n15. From the log dive outlined in previous steps, determine the likely attack vector (HTTP flood, SYN flood, credential stuffing, UDP reflection attack, etc.)\n16. What resources are being targeted? Note the Amazon resource names (ARN)\n17. Note specific information about the service hosted on the AWS resources For example, what type of application is it? What is the provenance of the application code? Are there other dependencies on this application?\n\n### Part 2: Contain the Incident\n\nFrom the Acquire, Preserve, Document Evidence phase, you should now have a good idea of the attack vector. The following steps describe how to help to mitigate the attack.\n\n1. If it is a single EC2 instance serving the public content:\n    1. determine from the application’s developer whether the application is “cloud native” (can handle things such as Amazon EC2 Auto Scaling, for example as application instances spin up and down).\n    2. Determine the AMI ID for the EC2 instance(s) identified during the evidence phase and determine if this is an approved image for this application\n    3. If there is no pre-defined image for spinning up additional EC2 instances, consult with the application developer whether an image can be created from the existing instance, and additional instances spun up from that image. If this is possible, proceed with those steps\n    4. From EC2 metrics in CloudWatch outlined in the evidence phase (Part 1), determine if the most suitable[EC2 instance type ](https://aws.amazon.com/ec2/instance-types/) is in use and/or if additional instances should be added behind an [AWS elastic load balancer](https://aws.amazon.com/elasticloadbalancing/) to spread the load\n    5. If so, this will allow you to scale additional EC2 instances using [Amazon EC2 Auto Scaling](https://docs.aws.amazon.com/autoscaling/ec2/userguide/GettingStartedTutorial.html), and put those instances behind an appropriate load balancer\n    6. Update DNS records in your Hosted Zone to point to the load balancer. For security groups on the EC2 instance, allow access only from the load balancer’s security group, and do not allow direct public access from any port or protocol\n2. If it is a group of EC2 instances behind a load balancer:\n    1. Determine if Amazon EC2 Auto Scaling is in use.\n        1. If not, create an Auto Scaling Group, define a [Launch Configuration](https://docs.aws.amazon.com/autoscaling/ec2/userguide/create-launch-config.html) or [Launch Template](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-launch-templates.html) and add the existing instances to the Auto Scaling Group\n        2. If it is in use, move to step (2b).\n    2. Confirm with the relevant stakeholders that CloudFront can be used and;\n    3. [Deploy a CloudFront distribution](https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/distribution-web-creating-console.html), using the load balancer as an origin for the distribution\n3. If it is a load balancer (or EC2 instance) behind a CloudFront distribution\n    1. Determine if it is a single EC2 instance serving as an origin:\n        1. If so, go to step 1 and work through those steps\n        2. If it is not, verify the following:\n            1. There is a load balancer\n            2. The target groups are spread across multiple Availability Zones\n            3. The EC2 instances are managed by EC2 Auto Scaling\n        3. If any of the points in (ii) are not true, go back and work through step 2, above\n        4. Finally, ensure that the security groups for the load balancer are appropriately configured. This can be done automatically by using AWS Lambda and the AWS published IP ranges for CloudFront. There is a [Git Repository with code that will set this up for you](https://github.com/aws-samples/aws-cloudfront-samples) and maintain the ranges if there are changes to the public IP ranges published.\n\n### Part 3: Eradicate the Incident\n\nBy following steps 1 through to 4 in PART 2, the service is now behind a CloudFront distribution, in addition to the standard protections provided by [AWS Shield](https://docs.aws.amazon.com/whitepapers/latest/aws-best-practices-ddos-resiliency/aws-best-practices-ddos-resiliency.pdf) . Now further refine protections by using AWS WAF.\n\n1. Determine if the CloudFront distribution or Application Load Balancer are protected by an AWS WAF WebACL.\n\n    1. For a CloudFront distribution:\n        1. Go to the CloudFront console and click on the name of the relevant distribution\n        2. Under the **General** tab, make note of the value in the AWS WAF Web ACL field\n        3. Go to the AWS WAF and Shield console and select Web ACLs from the navigation pane\n        4. Locate the Web ACL with the same name as noted from step (ii) and click on the name of the Web ACL listed under **AWS WAF**\n    2. For an Application Load Balancer:\n        1. Go to the EC2 console and select “Load Balancers” from the “Load Balancing” menu in the navigation pane\n        2. Select the name of the relevant Application Load Balancer and in the tabs below, select “Integrated services”\n        3. Note the name of the Web ACL listed under **AWS WAF**\n    3. Review the Web ACL and add rules if required;\n        1. The quickest solution is to deploy a set of AWS WAF Managed Rules. These are available in the AWS Marketplace for [third-party providers](https://aws.amazon.com/marketplace/solutions/security/waf-managed-rules). There are also AWS-Managed rules available directly from AWS when you [create a new Web ACL](https://aws.amazon.com/blogs/aws/announcing-aws-managed-rules-for-aws-waf/).\n        2. Alternatively, if the application developers know what type of rules should be deployed to protect the application, work with those developers to [create the rules](https://docs.aws.amazon.com/waf/latest/developerguide/classic-web-acl-rules-creating.html), deploy the Web ACL and then go back to step (a), above.\n\n2. If it is determined that the CloudFront distribution or Application Load Balancer are not protected by a Web ACL, take one of the two following steps:\n    1. If a Web ACL already exists and your CMDB shows that this Web ACL should be associated to either the CloudFront Distribution or the Application Load Balancer, go to the AWS console or AWS Command Line Interface (AWS CLI) tools and associate that resource to the Web ACL.\n    2. If no reference exists to a Web ACL in the CMDB that should be associated to either the CloudFront Distribution or Application Load Balancer, there are now two possible options:\n        1. If the CMDB contains references to known Web ACL rules that should be contained in a Web ACL, go ahead and create those rules and add them to a new Web ACL. Finally, associate that Web ACL to the resources to be protected.\n        2. If the CMDB does not contain references to Web ACL rules that should be deployed, the quickest solution is to deploy a set of AWS WAF Managed Rules. These are available in the AWS Marketplace for [third-party providers](https://aws.amazon.com/marketplace/solutions/security/waf-managed-rules). There are also AWS-Managed rules available directly from AWS when you [create a new Web ACL](https://aws.amazon.com/blogs/aws/announcing-aws-managed-rules-for-aws-waf/).\n        3. Alternatively, if the application developers know what type of rules should be deployed to protect the application, work with those developers to [create the rules](https://docs.aws.amazon.com/waf/latest/developerguide/classic-web-acl-rules-creating.html), deploy the Web ACL and then go back to step (a), above.\n\n### Part 4: Recover from the Incident\n\nThe next step is to determine if the attack has been mitigated, or if additional tuning is needed to eradicate the attack. This includes reviewing pre- and post-mitigation logs to:\n\n* Determine the impact of the mitigations already performed\n* Identify attack signatures to attempt to eradicate or further mitigate the attack\n\nFrom points (9) and (10) in PART 1, review the logs obtained once the incident was detected. Now that mitigations are in place, you need to go back and obtain those metrics and logs again, and compare them to the incident metrics and logs obtained earlier. If request activity has returned to baseline levels, and the service is confirmed to be available, the attack has subsided: Continue to monitor the service post-attack. If the service request rate is still elevated and the service is available, the attack has been mitigated: Continue to monitor the service for potential change in attack method. If the service is unavailable, return to Part 1 and review logs and related data to determine if you have correctly identified the attack vector, or if the attacker has changed the vector in response to the mitigation, or if your mitigations need to be refined.\n\n### Part 5: Post-Incident Activity\n\nThis “sharpen the saw” activity helps teams to assess their response to the actual incident, determine what worked and what didn’t, update the process based on that information and record these findings.\n\n\n1. Review the incident handling and the incident handling process with key stakeholders identified in Part 1, Step 6.\n2. Document lessons learned, including attack vector(s) mitigation(s), misconfiguration, etc.\n3. Store the artifacts from this process with the application information in the CMDB entry for the application and also in the CMDB entry for the DDoS Response process.\n4. Update risk documents based on any newly discovered threat/vulnerability combinations that were discovered as a result of lessons learned\n5. If new application or infrastructure configuration is required to mitigate any newly identified risks, conduct these change activities and update application and component configuration in the CMDB\n\n</s>"
  },
  {
    "text": "<s>[INST] <<SYS>>\nYou are a helpful cybersecurity assistant that generates detailed incident response playbooks based on established industry guides and best practices.\n<</SYS>>\n\nPlease generate a comprehensive DDoS response playbook, incorporating preparation, response, and post-attack analysis, based on the Involta/Incapsula DDoS Response Guide.\n[/INST] \n\n# DDoS Response Playbook (Based on Involta/Incapsula Guide)\n\n## Introduction\n\nThis playbook outlines pragmatic steps and best practices for planning and executing a DDoS response plan. Good preparation and planning can make the DDoS response process manageable and limit potential damage. This guide focuses on choosing and setting up mitigation solutions, responding to an attack, and conducting post-attack analysis.\n\n## Phase 1: Preparation\n\n### 1.1. Build Your DDoS Response Team\n\n* Identify the various people and departments within your organization who will be in charge of both planning and execution (e.g., marketing, operations, customer service/support, legal, and IT security).\n* Establish the roles/responsibilities of each team member for both planning and execution. Tasks include identifying and mitigating an attack, coordinating with ISPs, notifying customers, communicating with the press, and minimizing reputation/liability issues.\n\n### 1.2. Create a DDoS Response Plan\n\n* The purpose is to define resources, tools, and procedures required to minimize risk and costs before an incident occurs.\n* It should include topics such as risk assessment, organizational roles and responsibilities, mitigation strategies, monitoring, attack recovery, and communications planning.\n\n### 1.3. Conduct Risk Assessment\n\n* Understand the scope of your risk: Which infrastructure assets need protection?\n* Determine the cost of a given asset becoming unavailable.\n* Define thresholds for implementing your plan.\n* Prioritize web applications and externally-facing services first for DDoS resiliency.\n* Also consider other infrastructure like email servers, FTP servers, VoIP services, and back-office platforms (CRM, ERP).\n* Prioritize protection around infrastructure critical to *your* business (e.g., website downtime for e-commerce vs. back-office access for an insurance company).\n* Internal applications (only accessible via company network) may not require DDoS protection.\n\n### 1.4. Identify Single Points of Failure\n\n* Identify potential single points of failure such as your DNS server, router, bandwidth, firewalls, and other network equipment.\n* Protect mission-critical DNS servers, as a successful attack can render your systems unavailable even if they are otherwise protected.\n* Consider purchasing excess bandwidth or a dedicated link from your ISP to absorb additional traffic.\n* Implement system redundancy and disaster recovery options to get back online quickly.\n\n### 1.5. Strategize With Your ISP(s)\n\n* Clearly communicate with your ISP(s) as part of DDoS response preparation.\n* Understand your ISP's options for defending against DDoS attacks and their SLA regarding response times.\n* Ask your ISP:\n    * What type of DDoS protection does it offer?\n    * What types of DDoS attacks can it protect against (network layer, application layer)?\n    * What types of assets can it protect (DNS Servers, Infrastructure, Websites)?\n    * How much protection does it provide?\n    * What is its SLA in relation to mitigation time?\n    * Can it terminate service to your organization due to a DDoS attack?\n* Consider working with two ISPs for redundancy to maintain connectivity if your primary ISP is overwhelmed or discontinues service. Your primary ISP would handle mitigation, while the second ISP is used for other connectivity (phones, blog, etc.).\n\n### 1.6. Optimize DNS TTLs\n\n* Time to Live (TTL) determines how long DNS settings are cached with ISPs.\n* If using an on-demand, DNS-based DDoS mitigation solution, lower your TTL *prior* to an attack to allow for faster traffic rerouting through your mitigation solution (faster time-to-mitigation).\n\n### 1.7. Test DDoS Readiness\n\n* Turn on your DDoS mitigation measures for a test period (e.g., two hours every 3-4 months, or at least annually).\n* Certify that your systems and applications continue to function properly, traffic arrives, and there is no negative impact on users during the test.\n* Contact your provider before testing if they bill on a per-incident fee to avoid undue charges.\n\n### 1.8. Maintenance Aspects (Considerations)\n\n* Switching IP addresses is no longer an effective short-term method for avoiding DDoS attacks, as attacks often target entire IP ranges and are DNS-aware.\n* Upgrading to more robust equipment alone is insufficient, as bandwidth is finite and DDoS attack sizes continue to grow, potentially overwhelming your internet link upstream.\n\n### 1.9. Preparation Checklist (Summary from Involta/Incapsula)\n\n* **Build DDoS response team:**\n    * Identify people and departments involved.\n    * Define roles and responsibilities.\n* **Create DDoS response plan:**\n    * Define resources, tools, and procedures to minimize risk and costs.\n    * Ensure plan covers risk assessment, asset identification, ISP strategy, DNS optimization, and testing.\n* **Conduct risk assessment for:**\n    * Internet-facing applications and websites.\n    * Infrastructure assets.\n    * Third-party services.\n    * DNS services.\n* **Identify single points of failure:**\n    * DNS server.\n    * Bandwidth (Internet link size).\n    * Router and switches.\n    * Firewalls and other network equipment.\n* **Strategize with your ISP (Key Questions already covered in 1.5)**\n* **Other ISP-related issues:**\n    * Working with two ISPs for redundancy.\n    * Optimize your DNS TTLs.\n* **Test DDoS readiness:**\n    * Once every 3-4 months.\n\n### 1.10. DDoS Mitigation Solution Requirements (Key Capabilities)\n\n* **Attack Detection:**\n    * Should support automatic detection (<span class="math-inline">24 \\\\times 7</span> monitoring).\n    * Must scale on demand for massive network/protocol layer attacks.\n    * Must mitigate application layer attacks.\n    * Requires visibility into traffic type and users, not just traffic spikes.\n    * Needs to instantly stop the first bot in a botnet attack.\n* **Time-To-Mitigation:**\n    * Duration to start blocking an attack once identified.\n    * Should be a few seconds; longer is unacceptable.\n* **Client Classification:**\n    * Differentiate human vs. bot, and \"good\" vs. \"bad\" bots (search engines are good).\n    * Essential as most DDoS attacks are bot-performed.\n    * Use progressive challenge mechanisms (JS validation, cookies).\n* **Web Application Firewall (WAF):**\n    * Required for well-disguised Layer 7 DDoS attacks and multi-vector attacks where DDoS is a smokescreen.\n    * Analyzes application traffic, distinguishing risks from legitimate use.\n    * Shields against SQL injection, XSS, RFI, etc.\n    * Ensure provider has expertise against new/emerging techniques.\n* **Deployment Modes (Choose based on architecture):**\n    * **Always-on:** Instant identification and mitigation, quickest time-to-mitigation. More secure but consider system compatibility. Non-CDN based can add latency.\n    * **On-demand:** Engaged when an attack is detected. Activation can take time (e.g., up to 3 hours). Risk of downtime during initial stages.\n    * **DNS Redirection (for Web Apps):** Reroutes HTTP/HTTPS traffic through provider's scrubbing network. Easy onboarding, keep existing hosting. Performance depends on scrubbing network (CDN-based is better). Requires SSL certificate configuration.\n    * **BGP Routing (for entire subnets/multiple protocols):** On-demand, good for large volumetric/advanced attacks on any protocol (HTTP/S, SMTP, FTP, VoIP). Provides origin protection against direct-to-IP attacks. Traffic redirected via BGP announcements to scrubbing centers, clean traffic forwarded via GRE tunnel or cross-connect. Outbound traffic is asymmetric. May increase latency during attacks if no CDN. Often requires additional monitoring solution.\n    * **Dedicated IP (for smaller orgs, multiple services, no full C-class range):** Provider assigns a dedicated IP from their range. All traffic passes through their network for inspection. Secure two-way GRE tunnel for clean traffic.\n    * **DNS Proxy (for DNS servers):** Always-on. Proxy inspects incoming DNS requests, filters malicious ones, blocks DNS amplification attempts. Can be implemented quickly depending on TTL. Proxy becomes authoritative DNS, zone files managed externally. Can function as caching server if deployed globally (e.g., on CDN).\n    * **Physical Link / Cross-Connect (for infrastructure protection in shared data center):** Identical to BGP routing model, but uses a direct physical link instead of GRE tunnel. Requires infrastructure in same data center as provider. Assures predictable latency and max throughput.\n\n## Phase 2: Responding To an Attack\n\n### 2.1. Identifying an Attack\n\n* Early detection is pivotal to minimize impact. Frontline appliances are affected, volume increases, and performance degrades every second an attack goes unnoticed.\n* Some DDoS patterns exploit slow reaction times (e.g., \"hit-and-run\" bursts). Manual safeguards are often worthless in these situations.\n* Many intrusions are launched on weekends/holidays. Couple automatic detection with instant triggering of mitigation for effective <span class="math-inline">24 \\\\times 7</span> protection.\n\n### 2.2. Establish a War Room\n\n* Designate a \"war room\" (physical or virtual, e.g., existing SOC/NOC or conference room) as a planning and communications center during an attack.\n* Response team reviews security updates and strategizes defense schemes here.\n* Assign a lead responsible for all high-level security decisions during the attack.\n* **Crucial:** Do not assume organization email will be available. Keep response plans, team contact info (and key personnel, ISP, DNS providers) in a secure location independent of Internet access. A hard copy may be essential.\n\n### 2.3. Responding to Ransom Notes (If Applicable)\n\n* (46% of DDoS victims received ransom notes per Incapsula survey).\n* **Recommended Actions:**\n    1.  **Do not reply** to the note; negotiating is pointless.\n    2.  **Do not pay** the ransom. There's no guarantee attackers will honor commitment; amount may increase; organization may be targeted again.\n    3.  **Alert your response team** and try to weather the attack using an effective DDoS mitigation solution.\n    4.  **Inform your legal team** of the attack and send them a copy of the ransom note. Public companies may decide to disclose depending on length/impact.\n\n### 2.4. Execute Communications Plan\n\n* Communicating promptly with customers, partners, and the public is vital for preserving reputation. Keeping it secret fuels fears.\n* Explain the difference between a DDoS assault and data-compromising attacks to customers.\n* If your website/blog is down, use social channels (e.g., Twitter) for communication. This highlights the value of a secondary internet connection.\n* A communications plan helps minimize brand damage and financial impact, and prepares for questions.\n* **Dealing With Customers and Partners:**\n    * Maintain good faith; consumers are generally supportive if you're transparent.\n    * B2B service providers: Decide on transparency level as it could impact your clients' customers.\n    * Prepare financial compensation (discounts, service credits) in advance.\n    * Have reinforced call center and customer outreach teams on call after an outage.\n* **Communicating with Employees:**\n    * Ensure web ops team can reach key decision-makers or have authority.\n    * Inform non-IT employees impacted by unavailability of email/web-apps about the situation and provide backup/offline options.\n* **Dealing with the Media:**\n    * Nominate a single spokesperson in advance to ensure consistent messaging.\n    * PR team should have a pre-written blog post as part of crisis communication plan.\n    * Plan how to notify and respond to media inquiries if the attack scale warrants it.\n* **Legal and Regulatory Disclosures:**\n    * Few government-mandated requirements for DDoS reporting, as they don't typically fall under data breach regulations. This may be changing.\n    * U.S. SEC requires corporations to disclose cybersecurity risks. After 2013 bank attacks, SEC is considering specific DDoS disclosure requirements; some companies comply voluntarily.\n\n## Phase 3: Post-Attack Steps\n\n### 3.1. Process Analysis\n\n* Analyze gaps in DDoS response plan execution (technical and business) to improve for future incidents.\n* Evaluate:\n    * Preparation steps that could have made response faster/more effective.\n    * Adjust assumptions made during preparation (if necessary).\n    * Effectiveness of communications process.\n    * Relationships (internal/external) that could help in future incidents.\n\n### 3.2. Attack & Mitigation Analysis\n\n* As part of post-mortem, review intrusion impact to evaluate mitigation solution effectiveness.\n* Analyze security reports (e.g., WAF), SIEM alert logs, network monitoring tools.\n* Key questions to address:\n    * What type of DDoS attack targeted you (volumetric, application layer)? What was its size and duration?\n    * Which equipment helped mitigate, even if only partially successful?\n    * Which attack traffic had the most impact and why?\n    * Which systems suffered the most?\n* Answers help decide on equipment/service changes and focus protection on systems needing it most.\n\n</s>"
  },
  {
    "text": "<s>[INST] <<SYS>>\nYou are a helpful cybersecurity assistant that generates detailed incident response playbooks based on established industry guides and best practices.\n<</SYS>>\n\nPlease generate a playbook for responding to a Distributed Denial-of-Service (DDoS) attack, based on the CSA Singapore guide, including preparation, identification, containment, evidence acquisition, system hardening, and notification steps.\n[/INST]\n\n# Distributed Denial-of-Service (DDoS) Playbook (Based on CSA Singapore Guide)\n\n## Introduction\n\nThis playbook provides guidance to organisations on how to identify, contain and mitigate Distributed Denial-of-Service (DDoS) attacks, while minimising impact to business operations. The goal is to equip incident response teams with the tools and information needed to effectively respond to DDoS incidents and ensure that measures are taken to protect the organisation's critical systems and data.\n\n## Phase 1: Preparation (How to Protect Against DDoS Attacks)\n\nOrganisations should review their processes and implement appropriate defensive measures to create a more cyber-resilient environment and reduce the risk of DDoS attacks on their network. The following measures may help to prevent and mitigate DDoS attacks:\n\n### 1.1. Use Strong Passwords and Enable 2FA\n\nBy enforcing a strong password policy and implementing two-factor authentication, organisations can minimise the risk of unauthorised access and prevent attackers from compromising their systems, reducing the risk of DDoS attacks. Organisations are advised to:\n\n* Change all default passwords of your devices and routers to strong passwords (i.e. at least 12 characters with upper- and lower-case letters, numbers, and special characters).\n* Enable two-factor authentication (2FA) as an additional layer of security to prevent unauthorised access and possible takeover of your network devices and routers in the event of compromised credentials.\n\n### 1.2. Monitor and Examine Network Traffic for Unusual or Suspicious Activities\n\nBy monitoring and examining network traffic, organisations can detect and respond to DDoS attacks more quickly, reducing the impact of the attack. Organisations are advised to:\n\n* Understand baseline traffic patterns by regularly measuring the type of network devices used and volume of protocol traffic (i.e., UDP, TCP or ICMP).\n* Continuously monitor the network traffic by configuring firewalls and intrusion detection/prevention systems to detect anomalous traffic types, system capacity overloads and rogue devices connected to the network.\n* Report suspicious activities to the relevant IT vendor/department for further analysis.\n\n### 1.3. Protect Your Network Perimeter\n\nImplement protections at the network perimeter as a first line of defence to protect your organisation's private networks against DDoS attacks. Such protections can come in the form of demilitarised zone (DMZ) firewalls placed between internal networks and external connectivity points (i.e., internet-facing networks). Organisations are advised to:\n\n* Configure firewalls and routers to only accept traffic detailed in your organisation's security policy required for business operations and drop network packets that meet specific criteria (i.e., malformed and spoofed).\n* Define strict \"TCP keepalive\" and \"maximum connection\" on all perimeter devices, such as firewalls and proxy servers to prevent SYN flood attacks.\n* Rate limit the number of requests a server will accept over a certain time window to prevent volumetric DDoS attacks.\n* Consider port and packet size filtering.\n* Set acceptable thresholds for SYN, ICMP and UDP traffic.\n\n### 1.4. Maintain System Hygiene\n\nBy maintaining system hygiene, it can help to protect against DDoS attacks by minimising the attack surface and improving the overall security status of the targeted systems. Organisations are advised to:\n\n* Regularly check for potentially exploitable DDoS vulnerabilities and remediate them by applying the latest security patches to all devices and routers after appropriate testing.\n* Enable automatic updates for anti-virus/anti-malware software and perform a full scan of the machines in your network regularly.\n* Discontinue vulnerable devices that are approaching End of Life (EoL) or no longer supported by the vendor.\n* Remove unused programs and applications which can become vulnerable over time as they may not receive security updates, making them an attractive target for attackers.\n* Disable Universal Plug and Play (UPnP) on routers unless required for business operations.\n* Block unauthorised IP addresses, close or hide unused ports/IP addresses and disable port forwarding to protect your organisation from a targeted DoS/DDoS attack.\n\n### 1.5. Increase Network Bandwidth\n\nBy increasing the amount of available bandwidth, organisations can absorb the traffic generated by a DDoS attack and prevent target systems from being overwhelmed. Organisations are advised to:\n\n* Use content delivery networks (CDNs). CDNs are large, distributed networks of servers that help to distribute content for organisations and provide some degree of protection against DDoS attacks.\n* Implement Internet Service Providers and cloud-based DDoS protection services which provide additional bandwidth and filtering capabilities to defend against DDoS attacks. These services work by redirecting traffic to a cloud-based scrubbing centre where incoming traffic is filtered, and only legitimate traffic is forwarded to the targeted systems.\n* Ensure server redundancy by using a load-balancer and having multiple servers that can take over and continue to handle the workload. This helps to ensure that the targeted systems remain available, even if one server is unable to handle the traffic generated by a DDoS attack.\n* Implement Bastion Routers either on the outside of the firewall or inside a demilitarised zone (DMZ). These routers are public-facing and are designed to withstand high-bandwidth attacks through the internet.\n\n### 1.6. Raise Awareness\n\nOrganisations should conduct regular security awareness trainings for your employees, including how to identify suspicious activity and respond to DDoS attacks. Additionally, employees should be trained on the organisation's response plan and how to implement it in the event of an attack.\n\n## Phase 2: Incident Response Steps\n\nIf your organisation is a victim of a DoS or DDoS attack, the following steps may assist in containment, remediation, and system recovery:\n\n### Step 1: Identify the Attack\n\n* Verify that the suspicious traffic is indeed a DDoS attack by checking system logs and network traffic data.\n* Ensure that the loss of service is not due to other factors such as an internal server fault, or an Internet/Cloud Service Provider outage.\n* Check if the organisation is expecting a large volume of traffic (i.e. New service or product launch, time-limited promotions, etc.).\n* Identify the critical assets such as servers and databases that are being targeted by the attack.\n    * Obtain the IP addresses of the systems being targeted.\n    * Obtain the network diagram for the targeted systems.\n* Identify the services that the system provides (i.e. Web Server, DNS, Mail Server, etc.).\n* Identify the type of DDoS attack (Volumetric, Amplification, Syn Flood, Protocol, etc.).\n    * Get more details on the malicious packets (OSI layer, Destination Port Number, Communication Protocol, etc.).\n\n### Step 2: Contain the Attack\n\n* Identify if the DDoS attack exploits a particular service (i.e. ICMP) or is attacking a particular port. Disable that service or close the port if they are not essential to the operation of the targeted system.\n* Obtain the IP addresses of the incoming DDoS packets and implement access control to block those IP addresses.\n* Implement rate-limiting to restrict the number of packets that can be sent from a single IP address.\n* Check if the Internet or Cloud Service providers are able to provide the organisation with any form of DDoS defences:\n    * Scrubbing/Clean Pipe\n    * Sinkholing (Block known malicious IP addresses)\n    * Null routing (Implement as a last resort)\n* Divert traffic and swing operations to alternative servers, if any.\n\n### Step 3: Acquire Forensic Evidence for Root Cause Analysis\n\nCollecting forensic evidence will provide insights into the nature of the attack, including the type of DDoS attack, the source of the attack traffic, the impact of the attack and the types of systems targeted. Analyse the data to determine the root cause of the attack and identify any vulnerabilities that may have been exploited. The types of forensic evidence to collect include:\n\n* Network traffic logs from firewalls, routers, switches, and other network devices to identify the source and type of traffic involved in the attack.\n* System logs from servers and other systems to identify any unusual activity or performance issues.\n* Network flow data to analyse the volume and direction of traffic, and identify any patterns or anomalies.\n* Packet captures to analyse the contents of network traffic and identify any malicious payloads or exploits.\n\n### Step 4: Harden your Systems\n\nSystem hardening can help protect websites and networks against DDoS attacks and is crucial to ensure that the website remains available and accessible to legitimate users. Here are some steps to harden web resources:\n\n* Use web application firewalls (WAFs) to filter out traffic from known malicious IP addresses or ranges.\n* Implement rate limiting to restrict the amount of traffic that can be sent to the website from a single source or IP address.\n* Deploy load balancers to distribute incoming traffic across multiple servers, preventing a single server from being overloaded by a DDoS attack.\n* Keep network devices up to date with the latest firmware and security patches to address known vulnerabilities.\n* Review and update firewall and network security configurations to limit access to systems and protect against unauthorised traffic.\n* Perform network segmentation to separate critical assets from public-facing servers.\n* Subscribe to a DDoS protection service from either the Internet or Cloud Service Providers.\n\n### Step 5: Notify Stakeholders and Report the Incident\n\n* If you are an organisation, notify your customers, clients, suppliers and employees about potential system downtimes or compromised network devices.\n* If you suspect your organisation to be a victim of DDoS attacks, you are strongly advised to report the case to SingCERT via our Incident Reporting Form (https://go.gov.sg/singcert-incident-reporting-form) as the information could help alert and assist other individuals and organisations.\n* If monetary loss(es) or criminal activity is involved, you may lodge a police report at any neighbourhood police post or online.\n\n## Important Considerations\n\nNote: Several steps in incident response may be highly technical. If necessary, organisations should consider engaging a cybersecurity services vendor to assist with the investigation and/or remediation. Refer to relevant lists of Cybersecurity Advisory and Consultancy service providers if required. This playbook provides guidelines and recommendations and is intended purely as a guide and is not exhaustive. Always consult a trained cybersecurity professional for advice before making any business-critical decisions within your organisation.\n\nTo report any cybersecurity incidents, including DDoS attacks, please visit https://go.gov.sg/singcert-incident-reporting-form.\n\n</s>"
  },
  {
    "text": "<s>[INST] <<SYS>>\nYou are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident\n<</SYS>>\n\nPlease provide incident response playbook for Volumetric DDoS Attack? [/INST] Sure. Here is the information requested.\nTitle: : Incident Response Playbook for Volumetric DDoS Attack\n1. Preparation: : Objective: Establish contacts, define procedures, gather information to save time during an incident.\n1.1 Internet Service Provider Support\nContact your ISP to understand the DDoS mitigation services it offers.\nIf possible, subscribe to a redundant Internet connection and to an Anti-DDoS services provider.\nEstablish contacts with your ISP and law enforcement entities. Ensure you have an out-of-band communication channel.\nMake sure your ISP and DDoS mitigation service have a 24/7 phone support.\n1.2 Inventory\nCreate a whitelist of the IP addresses and protocols you must allow if prioritizing traffic during an attack. Include critical customers and key partners.\nDocument your IT infrastructure details, including business owners, IP addresses and circuit IDs, routing settings; prepare a network topology diagram and an asset inventory.\n1.3 Network Infrastructure\nDesign a network infrastructure without Single Point of Failure or bottleneck.\nDeploy DDoS protection services to handle high traffic volumes.\nDistribute your DNS servers and other critical services through different AS.\nHarden the configuration of network, OS, and application components that may be targeted by DDoS.\nBaseline your current infrastructure’s performance, so you can identify the attack faster and more accurately.\nIf your business is Internet dependent, consider purchasing specialized DDoS mitigation products or services.\nConfirm DNS time-to-live (TTL) settings for the systems that might be attacked. Lower the TTLs, if necessary, to facilitate DNS redirection if the original IP addresses get attacked. \nDepending on the criticality of your services, consider setting up a backup that you can switch on in case of an issue.\n1.4 Internal Contacts\nEstablish contacts for your IDS, firewall, systems, and network teams.\nCollaborate with the business lines to understand business implications of likely DDoS attack scenarios.\nInvolve your BCP/DR planning team in DDoS incidents.\n2. Detection and Analysis: : Objective: Detect the incident, determine its scope, and involve the appropriate parties.\n2.1 Communication\nPrepare an internal and an external communication template about DDoS incidents.\nIdentify the channel where this communication will be posted.\nThe “preparation” phase is to be considered as the most important element of a successful DDoS incident response.\n2.2 Analyze the Attack\nKeep in mind the DDoS attack could be a smokescreen hiding a more sophisticated and targeted attack.\nCheck your anti-DDoS service analysis and your scrubbing centre reports:\nUnderstand the logical flow of the DDoS attack and identify the infrastructure components affected by it.\nUnderstand if you are the target of the attack or a collateral victim.\nReview the load and log files of servers, routers, firewalls, applications, and other affected infrastructure.\nIdentify what aspects of the DDoS traffic differentiate it from benign traffic:\nSource IP addresses, AS, etc.\nDestination ports\nURLs\nProtocols flags\nUse network analysis tools to review the traffic\nIf possible, create a NIDS signature to differentiate between benign and malicious traffic.\n2.3 Involve Internal and External Actors\nContact your internal teams to learn about their visibility into the attack.\nContact your ISP to ask for help. Be specific about the traffic you’d like to control:\nNetwork blocks involved\nSource IP addresses\nProtocols\nNotify your company’s executive and legal teams.\n2.4 Check the Background\nFind out whether the company received an extortion demand as a precursor to the attack:\nCheck for emails in your security email gateway based on a keyword list.\nSome threat actors send extortion demands directly to the email addresses in the Whois records of the targeted website.\nLook for revendications of the attack on social media.\nSearch if anyone would have any interest in threatening your company:\nCompetitors\nIdeologically-motivated groups \nFormer employees\n3. Containment: : Objective: Mitigate the attack’s effects on the targeted environment.\n3.1 Containment Actions\nThrottle or block DDoS traffic as close to the network’s “cloud” as possible via a router, firewall, load balancer, specialized device, etc.\nTerminate unwanted connections or processes on servers and routers and tune their TCP/IP settings.\nIf possible, switch to alternate sites or networks using DNS or another mechanism. Blackhole DDoS traffic targeting the original IP addresses.\nSet up an alternate communication channel between you and your users/customers \nIf possible, route traffic through a traffic-scrubbing service or product via DNS or routing changes.\nConfigure egress filters to block the traffic your systems may send in response to DDoS traffic, to avoid adding unnecessary packets to the network.\nIn case of an extortion attempt, try to buy time with the fraudster. For example, explain that you need more time in order to get management approval.\n3.2 ISP or Anti-DDoS Service Actions\nIf the bottleneck is at the ISP’s or anti-DDoS service’s side, only they can take efficient actions. In that case, work closely with your ISP and/or anti-DDoS provider and make sure you share information efficiently.\n4. Eradication: : Objective: Take actions to remove the threat and avoid future incidents.\n4.1 Remediation Measures\nContact your ISP and/or anti-DDoS provider and make sure that they enforce remediation measures. Possible measures include:\nFiltering \nTraffic-scrubbing/Sinkhole/Clean-pipe\nIP public balancing/splitting/switching\nBlackhole Routing\nTechnical remediation actions can mostly be enforced by your ISP and/or anti-DDoS provider.\nIf the attack had a major impact, you may have to make an incident report to regulators. If the DDoS sponsors have been identified, consider involving law enforcement. This should be performed upon the direction of your company’s executive and legal teams.\n5. Recovery: : Objective: Restore the system to normal operations.\n5.1 Assess the End of the DDoS Condition\nEnsure that the impacted services are reachable again.\nEnsure that your infrastructure performance is back to your baseline performance.\n5.2 Rollback the Mitigation Measures\nSwitch back traffic to your original network.\nRestart stopped services.\nEnsure that the recovery-related actions are decided in accordance with the network teams. Bringing up services could have unexpected side effects.\n6. Lessons Learned: : Objective: Document the incident’s details, discuss lessons learned, and adjust plans and defenses.\n6.1 Report\nAn incident report should be written and made available to all applicable actors. The following topics should be covered:\nInitial detection\nActions and timelines of every important event\nWhat went right\nWhat went wrong\nImpact from the incident\nIndicators of compromise\n6.2 Lessons Learned\nActions to improve the DDoS management processes should be defined to capitalize on this experience. Consider what relationships inside and outside your organizations could help you with future incidents.</s>\n\n"},


{"text":"<s>[INST] <<SYS>>\nYou are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident\n<</SYS>>\n\nPlease provide incident response playbook for Protocol-Based DDoS Attack? [/INST] Sure. Here is the information requested.\nTitle: : NIST compliant Incident Response Framework Playbook for Protocol-Based Attacks DDoS Attack\n1. Preparation: : Objective: Establish Contacts, Define Procedures, Gather Information to Save Time During an Incident\nIdentify Critical Assets:\nDocumentation: Create an inventory of all OT assets, including hardware, software, and communication protocols. Focus on critical systems like SCADA, PLCs, and communication protocols such as Modbus and DNP3.\nPrioritization: Rank assets based on their importance to operations and potential impact of a disruption.\nEstablish Baselines:\nTraffic Monitoring: Continuously monitor network traffic to establish a baseline of normal activity.\nBehavioral Analysis: Use network behavior analysis tools to understand typical communication patterns and data flows.\nDevelop Incident Response Team (IRT):\nTeam Formation: Assemble a team with members from IT, OT, and security departments.\nRoles and Responsibilities: Define clear roles and responsibilities for each team member, including incident commander, communication lead, technical lead, and recovery lead.\nTraining:\nRegular Drills: Conduct regular training and simulation exercises for the IRT to recognize and respond to protocol-based attacks.\nKnowledge Sharing: Keep the team updated with the latest threats, attack vectors, and mitigation strategies.\nTools:\nNetwork Monitoring Tools: Deploy tools to monitor network traffic and detect anomalies.\nIDS/IPS: Implement Intrusion Detection and Prevention Systems to detect and block malicious traffic.\nProtocol Analyzers: Use protocol analyzers to scrutinize communication protocols for any unusual or malicious activity.\n2. Detection and Analysis: : Objective: Detect the Incident, Determine its Scope, and Involve the Appropriate Parties\nDetection\nAnomaly Detection:\nAlerts Configuration: Set up alerts for unusual protocol activity, such as a high volume of SYN packets or unexpected protocol commands.\nThresholds: Define thresholds for normal traffic and trigger alerts when these thresholds are exceeded.\nLog Monitoring:\nContinuous Monitoring: Continuously monitor and analyze logs from network devices, firewalls, and IDS/IPS.\nLog Analysis Tools: Use log analysis tools to correlate events and identify patterns indicative of an attack.\nReal-Time Alerts:\nSIEM Integration: Integrate Security Information and Event Management (SIEM) systems to aggregate and analyze logs from multiple sources.\nAlerting Mechanisms: Configure SIEM to send real-time alerts for suspicious protocol activity, ensuring rapid response.\nAnalysis\nIncident Categorization:\nAttack Type Identification: Determine the type of protocol-based attack (e.g., SYN flood, TCP connection flood) based on the detected anomalies.\nScope Determination: Assess the extent of the attack, including affected systems and potential entry points.\nImpact Assessment:\nCritical Systems Analysis: Evaluate the impact on critical OT systems and their operations.\nOperational Disruption: Determine the level of operational disruption and potential downtime.\nSource Identification:\nIP Address Tracking: Identify the source IP addresses involved in the attack.\nGeographical Analysis: Analyze the geographical origin of the attack to understand if it's targeted from a specific region.\n3. Containment: : Objective: Mitigate the Attack’s Effects on the Targeted Environment\nNetwork Segmentation:\nIsolate Segments: Quickly isolate affected network segments to prevent the spread of the attack.\nSecure Zones: Ensure critical systems are placed in secure network zones with strict access controls.\nRate Limiting:\nTraffic Limiting: Implement rate limiting on network devices to control the flow of suspicious traffic.\nAdaptive Controls: Use adaptive rate limiting to dynamically adjust based on the severity of the attack.\nAccess Control:\nRestrict Access: Immediately restrict access to critical systems and communication protocols during an attack.\nAuthentication: Enforce strong authentication mechanisms for accessing critical assets.\n4. Eradication: : Objective: Remove the Threat and Prevent Recurrence\nMitigation Tools:\nDDoS Protection: Deploy DDoS protection tools and services to filter out malicious traffic.\nSecurity Appliances: Utilize security appliances capable of deep packet inspection to identify and block malicious packets.\nBlock IPs:\nIP Blacklisting: Block IP addresses identified as sources of the attack.\nGeofencing: Implement geofencing to block traffic from regions identified as sources of attacks.\n5. Recovery: : Objective: Restore the System to Normal Operations\nSystem Checks:\nIntegrity Verification: Ensure all systems are functioning correctly and are free of malicious activity.\nPatch Vulnerabilities: Patch any identified vulnerabilities exploited during the attack.\nTraffic Normalization:\nGradual Restoration: Gradually restore normal traffic flow while closely monitoring for any residual malicious activity.\nPerformance Monitoring: Continuously monitor network performance to detect any abnormalities.\nData Integrity:\nData Verification: Verify the integrity of data and system configurations to ensure no tampering occurred.\nBackup Restoration: Restore data from backups if any corruption or loss is detected.\n6. Lessons Learned: : Objective: Document the Incident’s Details, Discuss Lessons Learned, and Adjust Plans and Defenses\nDocumentation:\nIncident Report: Document the incident, including the type of attack, detection methods, response actions, and timeline.\nLessons Learned: Record lessons learned and any gaps identified in the response process.\nReview and Improve:\nPost-Incident Review: Conduct a thorough review of the incident and the effectiveness of the response.\nPlan Updates: Update the IR plan based on findings and recommendations from the review.\nTraining Update:\nIncorporate Learnings: Integrate new knowledge and lessons learned into training programs.\nOngoing Training: Ensure continuous training and awareness programs are in place to keep the team prepared.</s>\n\n"}, 
{"text":"<s>[INST] <<SYS>>\nYou are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident\n<</SYS>>\n\nPlease provide incident response playbook for Volume-Based DDoS Attack ? [/INST] Sure. Here is the information requested.\nTitle: : NIST compliant Incident Response Framework Playbook for Volume-Based DDoS Attack\n1. Preparation: : Objective: Establish Contacts, Define Procedures, Gather Information to Save Time During an Incident\nIdentify Critical Network Paths:\nDocumentation: Create a detailed map of network infrastructure, highlighting critical network paths, routers, switches, firewalls, and bandwidth resources. Use network management tools to keep this documentation updated.\nPrioritization: Assign priorities to network paths based on their importance to OT operations, considering factors like data flow, control signals, and interdependencies.\nEstablish Baselines:\nTraffic Monitoring: Implement continuous network traffic monitoring to establish baselines for normal traffic volumes, patterns, and behavior using tools like NetFlow or sFlow.\nHistorical Analysis: Use historical data to understand seasonal or operational traffic variations and establish what constitutes normal traffic for different times of the day or operational conditions.\nIncident Response Team (IRT):\nTeam Formation: Assemble a dedicated IRT with members from network security, IT, OT, and operations departments. Include roles such as incident commander, network engineers, and communication leads.\nRoles and Responsibilities: Clearly define roles and responsibilities, ensuring that all team members understand their duties during an incident. Establish a communication plan for internal and external stakeholders.\nTraining:\nRegular Training: Conduct regular training sessions focused on recognizing and responding to volume-based attacks. Use simulation drills and tabletop exercises to enhance preparedness.\nCross-Training: Ensure that team members are cross-trained in both IT and OT aspects of network security to handle incidents more effectively.\nTools:\nNetwork Monitoring Tools: Deploy advanced network monitoring tools that provide real-time visibility into traffic patterns and volumes.\nDDoS Protection Services: Subscribe to DDoS protection services from ISPs or third-party providers that offer scrubbing centers and mitigation capabilities.\nTraffic Analysis Tools: Use traffic analysis tools to detect anomalies and provide insights into network performance and threats.\n2. Detection and Analysis: : Objective: Detect the Incident, Determine its Scope, and Involve the Appropriate Parties\nAnomaly Detection:\nThreshold-Based Alerts: Configure alerts for unusual traffic volumes, such as spikes in incoming or outgoing traffic that exceed established baselines.\nBehavioral Analytics: Employ behavioral analytics to detect deviations from normal traffic patterns, using machine learning to improve accuracy over time.\nLog Monitoring:\nContinuous Monitoring: Implement continuous monitoring and analysis of logs from network devices, including routers, switches, firewalls, and IDS/IPS.\nLog Correlation: Use log correlation tools to link related events and identify patterns indicative of a volume-based attack.\nReal-Time Alerts:\nSIEM Integration: Integrate logs from all network devices with a SIEM system for centralized monitoring and real-time alerting.\nAlert Prioritization: Configure SIEM to prioritize alerts based on the severity and potential impact on critical network paths, ensuring prompt response.\nIncident Categorization:\nAttack Identification: Determine the type of volume-based attack (e.g., UDP flood, ICMP flood) by analyzing the traffic characteristics and patterns.\nScope Determination: Assess the extent of the attack, including affected network segments, devices, and services.\nImpact Assessment:\nOperational Impact: Evaluate the impact on network bandwidth, latency, and the performance of critical OT systems.\nResource Utilization: Assess the utilization of network resources such as CPU, memory, and bandwidth during the attack.\nSource Identification:\nIP Tracking: Identify the IP addresses involved in the attack, using geolocation tools to determine the geographical origin of the traffic.\nBotnet Detection: Analyze traffic patterns to identify potential use of botnets and their command and control servers.\n3. Containment: : Objective: Mitigate the Attack’s Effects on the Targeted Environment\nTraffic Filtering:\nEdge Filtering: Implement traffic filtering at the network edge to drop packets identified as malicious based on IP addresses, protocols, or traffic patterns.\nGeofencing: Apply geofencing rules to block traffic from regions known to be sources of attacks.\nRate Limiting:\nTraffic Throttling: Apply rate limiting on network devices to control the flow of suspicious traffic and prevent overwhelming network resources.\nAdaptive Rate Limiting: Use adaptive rate limiting techniques that dynamically adjust thresholds based on real-time traffic analysis.\nAccess Control:\nRestrict Access: Temporarily restrict access to critical network paths and services to prevent further impact.\nSegmentation: Isolate affected network segments to contain the spread of the attack and protect unaffected areas.\n4. Eradication: : Objective: Remove the Threat and Prevent Recurrence\n\nMitigation Tools:\nDDoS Protection Services: Use DDoS protection services to filter out malicious traffic before it reaches the internal network. These services often include traffic scrubbing centers that clean incoming traffic.\nAdvanced Firewalls: Employ advanced firewalls with capabilities like deep packet inspection and behavior-based blocking to identify and block malicious traffic.\nBlock IPs:\nIP Blacklisting: Block IP addresses identified as sources of the attack at the firewall or router level.\nReputation-Based Blocking: Use reputation-based services to block IPs known for malicious activity.\n5. Recovery: : Objective: Restore the System to Normal Operations\nSystem Checks:\nNetwork Health: Perform thorough checks to ensure all network paths are functioning correctly and are free of malicious activity.\nDevice Health: Verify the health of network devices, ensuring they are operating normally and have not been compromised.\nTraffic Normalization:\nGradual Restoration: Gradually restore normal traffic flow while closely monitoring for any residual malicious activity.\nContinuous Monitoring: Continue monitoring network traffic to detect any signs of lingering or new attacks.\nData Integrity:\nConfiguration Verification: Verify the integrity of network configurations and ensure they match pre-attack settings.\nBackup Restoration: Restore network configurations from backups if any corruption or unauthorized changes are detected.\n6. Lessons Learned: : Objective: Document the Incident’s Details, Discuss Lessons Learned, and Adjust Plans and Defenses\nDocumentation:\nIncident Report: Document the incident comprehensively, including the type of attack, detection methods, response actions, timeline, and impact assessment.\nLessons Learned: Record lessons learned and any gaps identified in the response process.\nReview and Improve:\nPost-Incident Review: Conduct a thorough review of the incident with the IRT and other stakeholders. Discuss what went well and areas for improvement.\nPlan Updates: Update the IR plan based on findings and recommendations from the review.\nTraining Update:\nIncorporate Learnings: Integrate new knowledge and lessons learned into training programs. Ensure all relevant personnel are aware of the updates.\nOngoing Training: Schedule regular training and awareness sessions to keep the team prepared for future incidents.</s>\n\n"},

{"text":"<s>[INST] <<SYS>>\nYou are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident\n<</SYS>>\n\nPlease generate a Ransomware Incident Response Playbook? [/INST] Sure. Here is the information requested.\nTitle: : Incident Response Playbook for Ransomware Infection (NIST Compliant)\n1. Preparation: : Objective: To prepare for a potential ransomware attack by establishing an incident response plan and conducting initial assessments.\n\n\nStep-by-Step Guidance:\n\n1. Develop an incident response plan that includes roles and responsibilities, communication protocols, and procedures for reporting and responding to ransomware attacks.\n2. Identify critical systems and data that need to be protected and prioritize their backup and recovery.\n3. Conduct a baseline assessment of the current security posture to identify vulnerabilities and areas for improvement.\n4. Develop a list of trusted sources for threat intelligence and stay informed about the latest ransomware trends and tactics.\n2. Detection and Analysis: : Objective: To quickly identify and analyze a ransomware attack to determine its scope and impact.\n\nStep-by-Step Guidance:\n\n1. Implement monitoring tools to detect and alert on suspicious activity, such as unusual network traffic or file access.\n2. Conduct regular system scans to identify any unauthorized access or changes to systems and data.\n3. Establish a process for reporting and triaging incidents, including escalation procedures for critical incidents.\n4. Use incident response kits and checklists to guide analysts through the analysis process.\n5. Utilize threat intelligence feeds to inform analysis and identify the source of the attack.\n3. Containment: : Objective: To isolate and contain the ransomware attack to prevent further damage and limit the spread of the attack.\n\nStep-by-Step Guidance:\n\n1. Identify the affected systems and networks and isolate them from the rest of the network to prevent the attack from spreading.\n2. Implement a backup and recovery plan to restore affected systems and data.\n3. Conduct a thorough analysis of the attack to identify the initial entry point and the tactics, techniques, and procedures (TTPs) used by the attackers.\n4. Utilize incident response kits and checklists to guide analysts through the containment process.\n5. Consider the use of a \"ransomware kill switch\" to disable the attack if possible.\n4. Eradication: : Objective: To remove the ransomware from affected systems and networks.\n\nStep-by-Step Guidance:\n\n1. Implement a comprehensive response plan to remove the ransomware from affected systems and networks.\n2. Utilize anti-ransomware tools and software to remove the attack from affected systems.\n3. Conduct a thorough analysis of the attack to identify the TTPs used by the attackers and to improve the organization's defenses.\n4. Consider the use of a \"ransomware decryption tool\" to restore encrypted data.\n5. Document the incident and the steps taken to eradicate the attack for future reference.\n5. Recovery: : Objective: To restore affected systems and data to a known good state and to ensure business continuity.\n\nStep-by-Step Guidance:\n\n1. Develop a comprehensive recovery plan that includes procedures for restoring systems and data, as well as business continuity measures.\n2. Implement a backup and recovery plan to restore affected systems and data.\n3. Conduct a thorough analysis of the attack to identify the root cause and to improve the organization's defenses.\n4. Consider the use of a \"ransomware recovery tool\" to restore encrypted data.\n5. Document the incident and the steps taken to recover affected systems and data for future reference.\n6. Lessons Learned: : Objective: To document the incident and the response, and to identify areas for improvement in the incident response plan and the organization's overall security posture.\n\nStep-by-Step Guidance:\n\n1. Conduct a thorough post-incident review (PIR) to document the incident and the response.\n2. Identify the root cause of the incident and the TTPs used by the attackers.\n3. Document lessons learned and areas for improvement in the incident response plan and the organization's overall security posture.\n4. Utilize the incident response plan to improve the organization's defenses and to prevent similar incidents from occurring in the future.\n5. Share lessons learned with the organization and the broader security community to improve the overall security posture of the industry.</s>\n\n"},

{"text":"<s>[INST] <<SYS>>\nYou are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident\n<</SYS>>\n\nPlease generate an incident response playbook for Locker Ransomware in an OT Environment? [/INST] Sure. Here is the information requested.\nTitle: : Incident Response Playbook: Locker Ransomware in an OT Environment (NIST Compliant)\n1. Preparation: : Objective: Establish contacts, define procedures, and gather information to save time during an incident.\n1.1 Knowledge Requirements\nSecurity Policies: Ensure comprehensive understanding of security policies for operating systems and user profiles specific to OT systems.\nNetwork Architecture: Familiarize with architecture, VLAN segmentation, and interconnections within the OT environment to enable isolation of entities, regions, partners, or the Internet.\n1.2 Security Product Updates\nRegular Updates: Ensure that all security products, including endpoint and perimeter defenses (email gateway, proxy caches), are regularly updated to the latest versions.\n1.3 Endpoint Protection Deployment\nDeployment: Implement endpoint protection solutions on all endpoints and servers within the OT environment.\nFunctionality: Use these solutions for identifying, containing, and remediating ransomware attacks. Configure policies to block identified threats.\n1.4 IT Support Awareness\nAwareness Training: Conduct regular training sessions for IT and OT support staff to recognize ransomware threats and report suspicious activities promptly.\n1.5 Block IOCs\nIOC Blocking: Use threat intelligence to identify and block IOCs associated with ransomware activities.\n1.6 Security Solutions Deployment\nDetection Tools: Deploy security solutions for detection and response, such as SIEM for log gathering, and tools like YARA or DFIR-ORC (ANSSI).\n1.7 Log Management\nLog Retention: Ensure comprehensive log retention and verbosity to aid in incident detection and forensic analysis.\n1.8 Posture and Communication\nPosture Definition: Define a strict stance against attackers and prepare an internal and external communication strategy.\n1.9 Communication Protocols\nEstablish Protocols: Define clear communication methods for the incident response team, stakeholders, and the public to ensure effective coordination during an incident.\n1.10 Backups Preparation\nBackup Strategy: Ensure exhaustive, recent, and reliable backups of local and network data, following the 3-2-1 backup rule (three copies, two formats, one offsite).\nOffline Backup: Maintain at least one backup format stored offline to protect against lateral movement.\n2. Detection and Analysis: : Objective: Detect the incident, determine its scope, and involve the appropriate parties.\n2.1 General Signs of Locker Ransomware Presence\nIndicators:\nUser reports of being locked out of their systems.\nDisplayed ransom messages on locked screens demanding payment for unlocking.\nInability to access critical OT systems or control interfaces.\nReports of unusual system behavior or changes in system functionality.\n2.2 Immediate Response\nIsolation: Physically isolate the affected machines from the network to prevent further spread.\nNotification: Immediately notify the incident response team and relevant stakeholders.\nDocumentation: Document the symptoms and any ransom messages for further analysis.\n2.3 Scoping of the Incident\nScope Determination: Use endpoint protection and monitoring tools to identify all affected systems.\nAsset Inventory: Identify and prioritize critical OT systems affected by the ransomware.\n2.4 Threat Actor Identification\nThreat Actor ID: Identify the threat actor to leverage known TTPs for planning the response.\n3. Containment: : Objective: Mitigate the attack’s effects on the targeted environment.\n3.1 Public Statement\nCommunication: Issue a public statement based on pre-prepared templates to inform stakeholders and the public about the incident.\n3.2 Follow Defined Posture\nPosture Adherence: Implement the predefined stance against the attackers as established during the preparation phase.\n3.3 Security Provider Actions\nSample Submission: Send undetected samples to endpoint security providers and/or private sandboxes.\nBlock Threats: Block communication with C2 servers and malicious IPs, URLs, and domains identified during the incident.\n3.4 Isolation\nNetwork Isolation: Isolate compromised VLANs, entities, and regions to prevent the spread of ransomware.\nAccount Management: Disable accounts compromised or created by attackers.\nDevice Disconnection: Disconnect compromised computers from the network and shared drives. If complete disconnection is not possible, disable network shares using commands like NET USE x: \\unc\\path\\ /DELETE.\nMonitor Data Leaks: Monitor ransomware threat actor websites for data leak publications.\n4. Eradication: : Objective: Take actions to remove the threat and avoid future incidents.\n4.1 Remove Threat\nInitial Access Removal:\nIdentify and close vulnerabilities or security gaps used by attackers.\nApply the latest security patches to affected systems.\nReview and update firewall rules and configurations.\nBinary Removal:\nUse endpoint protection tools and antivirus software to scan for and remove malicious binaries.\nPerform deep scans to ensure no residual malware remains.\nAccount Management:\nDisable and remove accounts created by attackers.\nRevert unauthorized changes to existing accounts.\nEnforce strong password policies and multi-factor authentication (MFA).\nConfiguration Reversion:\nRevert unauthorized configuration changes made by attackers.\nRestore system configurations to known good states using documented baselines.\nSystem and Network Hardening:\nDisable unnecessary services and ports, apply security patches, and enforce least privilege principles.\nEnsure proper network segmentation to limit the spread of future attacks.\nImplement network access control (NAC) to enforce security policies on connected devices.\nThird-Party and Vendor Assessment:\nReview third-party connections and vendor access to the network.\nImplement stricter controls and monitoring for third-party access.\nEnsure third-party services and software are up to date and secure.\n4.2 Incident-Specific Remediation Actions\nIdentify and Mitigate Exploited Vulnerabilities:\nUse threat intelligence and vulnerability management tools to identify and patch vulnerabilities exploited during the attack.\nAdvanced Threat Detection:\nImplement IDS/IPS to monitor for attack techniques used during the incident.\nEnhance monitoring and alerting for abnormal activities related to the ransomware strain.\n4.3 Collaboration and Coordination\nEngage with Cybersecurity Experts:\nCollaborate with external cybersecurity experts or incident response teams for forensic analysis and threat eradication.\nShare Threat Intelligence:\nShare IOCs and attack details with industry groups and threat intelligence communities.\n4.4 Validation and Verification\nComprehensive Scans and Testing:\nConduct comprehensive scans and penetration tests to ensure no residual threats remain.\nVerification of System Integrity:\nUse integrity monitoring tools to verify the integrity of critical system files and configurations.\n4.5 Security Awareness and Training\nEmployee Education:\nConduct security awareness training sessions focusing on ransomware prevention, detection, and response.\nRegular Drills and Simulations:\nPerform regular incident response drills and tabletop exercises to ensure preparedness.\n4.6 Policy and Procedure Updates\nReview and Update Policies:\nUpdate security policies and procedures based on lessons learned.\nStrengthen Access Controls:\nImplement stronger access controls, such as RBAC, to minimize the risk of unauthorized access.\n4.7 Continuous Improvement\nPost-Incident Review:\nConduct a thorough post-incident review to identify areas for improvement.\nDocument lessons learned and update the incident response plan.\nImplement Feedback Loops:\nEstablish feedback loops to continuously improve detection, response, and remediation processes.\n5. Recovery: : Objective: Restore the system to normal operations.\n5.1 System Unlock and Restoration\nUnlock Systems: Use decryption keys if available or collaborate with security experts to unlock systems without paying the ransom.\nMalicious Binary Removal: Ensure all ransomware-related binaries are removed before system restoration.\n5.2 Document Restoration\nRestore Documents: Restore user documents from clean backups following the disaster recovery plan (DRP).\nStep-by-Step Recovery: Follow a structured recovery plan, prioritizing critical systems and continuously monitoring for issues.\n5.3 Backup Verification and System Reimaging\nVerify Backups: Ensure backups are clean before restoration. Reimage systems if necessary.\n5.4 Credential Reset\nReset Credentials: Change all credentials, especially for administrator and system accounts.\n5.5 Network Monitoring\nMonitor Traffic: Continuously monitor network traffic for residual infections and apply geo-filtering to block illegitimate foreign traffic.\nData Leak Monitoring: Maintain vigilance for any data leak publications related to the ransomware attack.\n6. Lessons Learned: : Objective: Document the incident’s details, discuss lessons learned, and adjust plans and defenses.\n6.1 Incident Report\nReport Creation: Document the incident’s details, including causes, actions, timelines, successes, failures, costs, and IOCs.\n6.2 Capitalize\nImprove Detection: Define actions to enhance malware and network intrusion detection processes based on the incident experience.\nUpdate Training: Integrate lessons learned into ongoing security training and awareness programs for staff.</s>\n\n"},{"text":"<s>[INST] <<SYS>>\nYou are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident\n<</SYS>>\n\nPlease generate an incident response playbook for ransomware attack in OT environment? [/INST] Sure. Here is the information requested.\nTitle: : Incident Response Playbook for Ransomware Infection\n1. Preparation: : Objective: Establish contacts, define procedures, gather information to save time during an incident.\n1.1 Knowledge Requirements\nSecurity Policies: Ensure comprehensive understanding of security policies for operating systems and user profiles.\nNetwork Architecture: Familiarize with architecture, VLAN segmentation, and interconnections to enable isolation of entities, regions, partners, or the Internet.\n1.2 Security Product Updates\nRegular Updates: Ensure endpoint and perimeter security products (email gateway, proxy caches) are up to date.\n1.3 EDR Solution Deployment\nDeployment: Implement EDR solutions on endpoints and servers.\nFunctionality: Use EDR for identification, containment, and remediation. Launch EDR searches and AV scans with IOC rules for progress indicators.\nPolicies: Set EDR policies to prevent mode.\n1.4 IT Support Awareness\nAwareness Training: Educate IT support on ransomware threats and detection.\n1.5 Block IOCs\nIOC Blocking: Block IOCs linked to ransomware activities using Threat Intelligence.\n1.6 Security Solutions Deployment\nDetection Tools: Deploy security solutions for detection and response, such as SIEM for log gathering and tools like YARA or DFIR-ORC (ANSSI).\n1.7 Log Management\nLog Retention: Maintain comprehensive log retention and verbosity.\n1.8 Posture and Communication\nPosture Definition: Define a strict posture against attackers.\nCommunication Strategy: Prepare internal and external communication plans.\n1.9 Communication Protocols\nEstablish Protocols: Define communication methods for the incident response team, stakeholders, and the public.\n1.10 Backups Preparation\nBackup Strategy: Ensure exhaustive, recent, and reliable backups of local and network data.\n3-2-1 Rule: Maintain three copies in two different formats, with one offsite. Use one backup format stored off the network.\n2. Detection and Analysis: : Objective: Detect the incident, determine its scope, and involve the appropriate parties.\n2.1 General Signs of Ransomware Presence\nIndicators:\nMonitoring of ransomware IOCs by SOC.\nSupervision of EDR alerts.\nOdd emails with suspicious attachments.\nRansom messages on desktops.\nFile availability issues with unusual extensions.\nRapid file modifications on network shares.\nData leak publications by ransomware operators.\nUnusual network activity or web Browse.\n2.2 Immediate Response\nIsolation: Unplug infected machines from the network and keep them on for memory forensics.\n2.3 Scoping of the Incident\nScope Determination: Use EDR, YARA, or DFIR-ORC to identify ransomware-infected machines and the attack's initial access point.\n2.4 Threat Actor Identification\nThreat Actor ID: Identify the threat actor to leverage known TTPs for response planning.\n3. Containment: : Objective: Mitigate the attack’s effects on the targeted environment.\n3.2 Follow Defined Posture\nPosture Adherence: Implement the predefined posture from the preparation phase.\n3.3 Security Provider Actions\nSample Submission: Send undetected samples to security providers.\nBlock Threats: Block C2 traffic, malicious IPs, URLs, and domains.\n3.4 Isolation\nNetwork Isolation: Isolate compromised VLANs, entities, and partners. Disable compromised accounts.\nDisconnect Devices: Disconnect compromised computers from the network and shared drives.\nMonitor for Data Leaks: Keep an eye on ransomware threat actor websites for data leak publications.\n3.5 Public Statement\nCommunication: Issue a public statement based on pre-prepared templates.\n4. Eradication: : Objective: Take actions to remove the threat and avoid future incidents.\n4.1 Remove Threat\nInitial Access Removal:\nIdentify and close any vulnerabilities or security gaps used by attackers to gain initial access.\nPatch all affected systems with the latest security updates.\nReview and update firewall rules and configurations to prevent unauthorized access.\nBinary Removal:\nUse EDR tools and antivirus software to scan for and remove malicious binaries and tools used by attackers.\nPerform deep scans on all systems to ensure no residual malicious software remains.\nAccount Management:\nDisable and remove any accounts created by the attackers.\nReview and remove any unauthorized changes to existing accounts, such as added privileges.\nEnforce strong password policies and multi-factor authentication (MFA) for all accounts.\nConfiguration Reversion:\nRevert any unauthorized configuration changes made by attackers.\nRestore system configurations to known good states using documented baselines.\nSystem and Network Hardening:\nImplement hardening measures across all systems and network devices. This includes disabling unnecessary services and ports, applying security patches, and enforcing least privilege principles.\nEnsure proper network segmentation to limit the spread of potential future attacks.\nUse network access control (NAC) to enforce security policies on devices trying to access the network.\nThird-Party and Vendor Assessment:\nConduct a thorough review of third-party connections and vendor access to the network.\nImplement stricter controls and monitoring for third-party access.\nEnsure all third-party services and software are up to date and secure.\n4.2 Incident-Specific Remediation Actions\nIdentify and Mitigate Exploited Vulnerabilities:\nUse threat intelligence and vulnerability management tools to identify vulnerabilities exploited during the attack.\nPrioritize and apply patches to mitigate these vulnerabilities across all systems.\nAdvanced Threat Detection:\nImplement advanced threat detection solutions, such as intrusion detection/prevention systems (IDS/IPS), to monitor for signs of attack techniques used during the incident.\nEnhance monitoring and alerting for abnormal activities related to the specific ransomware strain.\n4.3 Collaboration and Coordination\nEngage with Cybersecurity Experts:\nCollaborate with external cybersecurity experts or incident response teams to gain insights and assistance in threat removal and remediation.\nUtilize their expertise to conduct thorough forensics and ensure complete eradication of threats.\nShare Threat Intelligence:\nShare IOCs and attack details with relevant industry groups and threat intelligence communities to aid in broader defense efforts.\nStay updated with threat intelligence feeds to quickly react to new threats and indicators.\n4.4 Validation and Verification\nComprehensive Scans and Testing:\nConduct comprehensive scans and penetration tests to ensure no residual threats remain.\nValidate that all systems are free from malware and unauthorized modifications.\nVerification of System Integrity:\nUtilize integrity monitoring tools to verify the integrity of critical system files and configurations.\nRegularly compare current system states with known good baselines to detect and remediate unauthorized changes.\n4.5 Security Awareness and Training\nEmployee Education:\nConduct security awareness training sessions focusing on ransomware prevention, detection, and response.\nEnsure employees understand the importance of reporting suspicious activities and adhering to security policies.\nRegular Drills and Simulations:\nPerform regular incident response drills and tabletop exercises to ensure the team is prepared for future incidents.\nSimulate ransomware attack scenarios to practice detection, containment, and remediation steps.\n4.6 Policy and Procedure Updates\nReview and Update Policies:\nReview and update security policies and procedures based on lessons learned from the incident.\nEnsure policies reflect current best practices and address any gaps identified during the response.\nStrengthen Access Controls:\nImplement stronger access controls, such as role-based access control (RBAC), to minimize the risk of unauthorized access.\nRegularly review and update access permissions to ensure they align with the principle of least privilege.\n4.7 Continuous Improvement\nPost-Incident Review:\nConduct a thorough post-incident review to identify areas for improvement.\nDocument lessons learned and incorporate them into the organization's incident response plan.\nImplement Feedback Loops:\nEstablish feedback loops to continuously improve detection, response, and remediation processes.\nRegularly review and refine incident response strategies to stay ahead of evolving threats.\n5. Recovery: : Objective: Restore the system to normal operations.\n5.1 Antivirus and Malicious Binaries\nUpdate AV: Ensure antivirus signatures are updated and malicious binaries are removed.\n5.2 Document Restoration\nRestore Documents: Restore user documents from clean backups following the DRP.\n5.3 Backup Verification and System Reimaging\nVerify Backups: Ensure backups are clean before restoration. Reimage systems if necessary.\n5.4 Credential Reset\nReset Credentials: Change all credentials, especially for administrator and system accounts.\n5.5 Network Monitoring\nMonitor Traffic: Continuously monitor network traffic for residual infections and apply geo-filtering.\n6. Lessons Learned: : Objective: Document the incident’s details, discuss lessons learned, and adjust plans and defenses.\n6.1 Incident Report\nReport Creation: Document the incident’s details, including causes, actions, timelines, successes, failures, costs, and IOCs.\n6.2 Capitalize\nImprove Detection: Define actions to enhance malware and network intrusion detection processes based on the incident experience</s>\n\n"},
{"text":"<s>[INST] <<SYS>>\nYou are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident\n<</SYS>>\n\nPlease generate a incident response playbook to respond a ransomware attack? [/INST] Sure. Here is the information requested.\nTitle: : Incident Response Playbook for Ransomware Infection (NIST Compliant)\n1. Preparation: : Objective: Establish contacts, define procedures, gather information to save time during an incident. \n1.1 Develop and Maintain Policies:\nEnsure all relevant policies are documented and reviewed regularly.\nEstablish an incident response policy that includes ransomware.\n1.2 Identify Critical Assets:\nMaintain an updated inventory of critical systems and data.\nPrioritize assets based on business impact analysis.\n1.3 Conduct Training and Awareness:\nRegularly train staff on ransomware threats and incident response procedures.\nConduct phishing simulations and other exercises to prepare users.\n1.4 Establish Incident Response Team (IRT):\nDefine roles and responsibilities within the IRT.\nEnsure the IRT is trained and familiar with the ransomware response playbook.\n1.5 Deploy and Configure Tools:\nEnsure tools for detection, analysis, containment, and eradication are in place and configured.\nRegularly update antivirus, EDR, and backup solutions.\n2. Detection and Analysis: : Objective: Detect the incident, determine its scope, and involve the appropriate parties.\n2.1 Determine the type of ransomware\nFind any related messages. Check:\nGraphical user interfaces (GUIs) for the malware itself.\nText or HTML files, sometimes opened automatically after encryption.\nImage files, often as wallpaper on infected systems.\nContact emails in encrypted file extensions.\nPop-ups after trying to open an encrypted file.\nVoice messages.\nAnalyze the messages looking for clues to the ransomware type:\nRansomware name.\nLanguage, structure, phrases, artwork.\nContact email.\nFormat of the user ID.\nRansom demand specifics.\nPayment address in case of digital currency.\nSupport chat or support page.\nAnalyze affected and/or new files. Check:\nFile renaming scheme of encrypted files including extension and base name.\nFile corruption vs encryption.\nTargeted file types and locations.\nOwning user/group of affected files.\nIcon for encrypted files.\nFile markers.\nExistence of file listings, key files, or other data files.\nAnalyze affected software or system types.\nUpload indicators to automated categorization services like Crypto Sheriff, ID Ransomware, or similar.\n2.2 Determine the scope:\nWhich systems are affected?\nScan for concrete indicators of compromise (IOCs) such as files/hashes, processes, network connections, etc. Use endpoint protection/EDR, endpoint telemetry, system logs, etc.\nCheck similar systems for infection: check IAM tools, permissions management tools, directory services, etc.\nFind external command and control (C2), if present, and find other systems connecting to it: check firewall or IDS logs, system logs/EDR, DNS logs, netflow or router logs, etc.\nWhat data is affected?\nFind anomalous changes to file metadata such as mass changes to creation or modification times. Check file metadata search tools.\nFind changes to normally-stable or critical data files. Check file integrity monitoring tools.\n2.3 Assess the impact to prioritize and motivate resources\nAssess functional impact: impact to business or mission.\nHow much money is lost or at risk?\nHow many (and which) missions are degraded or at risk?\nAssess information impact: impact to confidentiality, integrity, and availability of data.\nHow critical is the data to the business/mission?\nHow sensitive is the data?\nWhat is the regulatory status of data?\n2.4 Find the infection vector\nCheck the tactics captured in the Initial Access tactic of MITRE ATT&CK. Common specifics and data sources include:\nEmail attachment: check email logs, email security appliances and services, e-discovery tools, etc.\nInsecure remote desktop protocol (RDP): check vulnerability scanning results, firewall configurations, etc.\nSelf-propagation (worm or virus) (check host telemetry/EDR, system logs, forensic analysis, etc.)\nInfection via removable drives (worm or virus)\nDelivered by other malware or attacker tool: expand investigation to include additional attacker tools or malware.\n2.5 Communication\nNotify senior leadership about the potential ransomware incident.\nProvide initial findings and potential impacts.\nEnsure all detection and analysis activities are documented.\nRecord details of the ransomware type, scope of impact, and initial response steps.\nDiscuss legal implications, compliance requirements, and potential liabilities.\nDetermine the need for law enforcement involvement.\n3. Containment: : Objective: Mitigate the attack’s effects on the targeted environment.\n3.1 Immediate Containment:\nDisconnect affected systems from the network.\nQuarantine impacted user accounts and groups.\nBlock malicious IPs"},

]

[
  {
    "text": "<s>[INST] <<SYS>>\nYou are a helpful cybersecurity assistant that generates detailed incident response playbooks based on established industry guides and best practices, such as those from NIST and Microsoft.\n<</SYS>>\n\nPlease generate a comprehensive Ransomware Incident Response Playbook based on the Microsoft Security framework and checklist.\n[/INST] \n\n# Ransomware Incident Response Playbook (Based on Microsoft Security Framework)\n\n## Introduction\nThis playbook provides a step-by-step guide to proactively mitigate, detect, respond, and recover from ransomware incidents. It defines key stakeholders, processes, policies, and prevention plans based on the NIST SP800-61 Rev 2 guidelines, structured into four primary phases.\n\n## Phase 1: Preparation\n\nPreparation is foundational for effective incident response. Customize these sections for your organization.\n\n### 1.1 Roles and Responsibilities\n* Clearly define key stakeholders.\n* Provide up-to-date roles and responsibilities.\n* Outline necessary actions if a ransomware attack is detected.\n\n### 1.2 Security Awareness Training\n* Implement company-wide required security training.\n* Communicate dangers of malicious threats and guidance on identifying suspicious activity with steps to protect.\n* Educate users on how to report questionable activity to security teams.\n\n### 1.3 Data Backups and Recovery\n* All important data and metadata must be backed up periodically in a vault that is immutable, air-gapped, and caged.\n* Partial drills are recommended to make sure data is valid and recoverable.\n* Regularly exercise your business continuity/disaster recovery (BC/DR) plan.\n* Protect supporting documents required for recovery such as restoration procedure documents, your configuration management database (CMDB), and network diagrams.\n\n### 1.4 Endpoint Protection\n* Ensure programs, policies, and procedures are in place to manage endpoint and mobile device security.\n* Make devices more resilient to ransomware and other malware infections.\n* Examples: harden requirements, install antivirus and antimalware solutions, update operating systems and applications.\n* Invest in XDR-driven solutions like Microsoft Defender for Endpoint to secure your devices.\n* Provide modern endpoint protection across all platforms.\n* Prevent device & system tampering.\n* Reduce the attack surface with rules that enable/disable specific device behaviors.\n* Block known threats at first sight.\n* Manage device settings at scale.\n* Apply security baselines to harden internet-facing servers, clients, and applications.\n* Maintain updated software.\n* Isolate, disable, or retire vulnerable systems and protocols.\n* Block suspicious traffic with host-based firewalls and network defenses.\n* Rapidly isolate compromised devices with advanced endpoint protection.\n\n### 1.5 Network Protection\n* Ensure programs, policies and procedures are deployed to monitor and secure entry and egress points to the network.\n* Examples: firewalls, use of least privilege access, enforce strong authentication methods such as multifactor authentication (MFA), antispam solutions for email, physical security.\n* Invest in a SIEM-powered software like Microsoft Sentinel for access to advanced insights with built-in behavioral analytics.\n\n### 1.6 Security Policies\n* Security policies should be kept current and be enforced for all identities, users, and accounts that have access to company assets and resources.\n\n### 1.7 Documentation and Drills\n* Full recovery procedures should be documented and updated with every major service release.\n* Implement full drills to confirm key stakeholders are prepared to jump into action if an incident occurs.\n\n### 1.8 Ransomware Defense Checklist (Detailed Preparations)\n\n**Prevent attackers from getting in:**\n* **Remote access:**\n    * Secure multicloud and hybrid environments.\n    * Get full visibility of your SaaS apps.\n    * Maintain software and app updates.\n    * Enforce Zero Trust user/device validation.\n    * Configure security for third-party VPN solutions.\n    * Deploy Point-to-Site (P2S) VPN.\n    * Publish on-premises web apps with Application Proxy.\n    * Secure cloud resource access for the entire organization.\n* **Email and collaboration:**\n    * Implement modern email security.\n    * Enable attack surface reduction (ASR) rules to block common attack techniques.\n* **Identities:**\n    * Protect your on-premises identities with cloud-powered intelligence.\n    * Enforce strong MFA or passwordless sign-in for all users.\n    * Strengthen password security to protect against breaches.\n    * Prioritize common entry points and monitor for brute-force attempts like password spray.\n\n**Prevent attackers from escalating their privileges:**\n* **Privileged access strategy:**\n    * Enforce end-to-end security for admin portals using conditional access.\n    * Protect and monitor identity systems to prevent escalation attacks.\n    * Use privileged identity management (PIM) time-based and approval-based role activation.\n    * Use privileged access management (PAM) to limit access to sensitive data or critical configuration settings.\n* **Detection and response (related to privilege):**\n    * Detect and mitigate lateral traversal with compromised devices.\n    * Don't ignore commodity malware (often part of an attack chain).\n    * Monitor for an adversary disabling security solutions.\n\n**Protect your critical data from access and destruction:**\n* **Secure backups:**\n    * Automatically backup all critical systems on a regular cadence.\n    * Protect backups against deliberate erasure and encryption:\n        * Strong protection: require out-of-band steps (MFA or PIN) before modifying online backups.\n        * Strongest protection: store backups in online immutable storage and/or fully offline or off-site.\n* **Data protection:**\n    * Migrate your organization to the cloud: Move user data to cloud solutions like OneDrive/SharePoint to take advantage of versioning and recycle bin capabilities.\n    * Educate users on how to recover their files by themselves to reduce delays and cost of recovery.\n    * Designate protected folders.\n    * Review your permissions: Discover broad write/delete permissions on file sharing. Broad is defined as many users having write or delete permissions for business-critical data.\n    * Reduce broad permissions while meeting business collaboration requirements.\n    * Audit and monitor to ensure broad permissions don't reappear.\n* **Operational logs:**\n    * Monitor for event log clearing, especially the security event log and PowerShell logs (associated with some groups).\n\n**General Detection and Response Capabilities (Preparation):**\n* Gain visibility across your entire digital estate with a modern SIEM.\n* Automatically stop attacks and coordinate response across assets with XDR.\n* Combine SIEM+XDR to increase efficiency and effectiveness while securing your digital estate.\n* Gain access to global threat intelligence to identify external tools and systems used by attackers in SIEM+XDR incidents.\n* Provide high-quality alerts, minimize friction and manual steps during response.\n* Integrate incident response experts with global threat intelligence to provide professional guidance.\n\n### 1.9 Playbook Refresh Cadence\n* Playbooks are most effective as living documents, updated semi-annually or if:\n    * A ransomware incident occurs.\n    * Tabletop exercises or simulations are conducted.\n    * Changes in key business stakeholders occur.\n    * Major changes in the ransomware ecosystem happen.\n\n## Phase 2: Detection and Analysis\n\n* Stay informed on common attack vectors used in ransomware attacks.\n* Strategize and document security detection and response plans, which may differ depending on the method of attack.\n* Create a process flow to show the end-to-end process of incidents detected, reported, triaged, and resolved.\n* **Common attack methods (according to NIST):**\n    * Email attachments and embedded malicious links.\n    * Web browser vulnerabilities.\n    * Infected programs bundled with malware.\n    * Portable USB devices.\n* Incident response teams should implement consistent methods of evaluating and prioritizing ransomware events to determine required escalations.\n* Create an incident impact matrix (e.g., Critical, High, Moderate, Low) to determine required escalation and action.\n\n## Phase 3: Containment, Eradication, and Recovery\n\n### 3.1 Containment\n* A containment strategy should define actions once a system is identified as potentially having ransomware.\n* **Single-system examples:** Shut down system, disconnect from network, disable certain functions.\n* **Multi-system examples:** Disconnecting broadly-impacted sites to prevent lateral movement if impact is isolated, or disabling outbound connectivity at site level to cut attacker command and control.\n\n### 3.2 Eradication\n* After containment, enforce procedures to eradicate ransomware.\n* **Eradication examples:** Delete malware, disable breached user accounts, and mitigate all exploited vulnerabilities.\n* Perform root cause analysis (RCA) to potentially determine the type of ransomware and attack infiltration method to implement mitigation controls against future similar attacks.\n\n### 3.3 Recovery\n* Containment and RCA activities should be performed before recovery procedures.\n* Recovery plans should be documented to outline how affected files and data will be restored by reliable and secure backup sources.\n\n## Phase 4: Post-incident Response\n\nAll security incidents should have a post-incident response (PIR) completed. In a PIR, security incident responders should work with responsible parties to:\n\n* Identify the root cause of the incident and create high-level plans to prevent future incidents with similar patterns.\n* Implement mitigating technical controls to address identified gaps.\n* Identify technical or communication lapses, procedural failures, manual errors, and process flaws that could potentially influence a delay in threat response.\n* Evaluate response procedures for sufficiency and completeness of operating procedures.\n* Evaluate and improve cybersecurity training for employees.\n* Enforce company-wide security policies.\n\n## Additional Stakeholder Roles in Playbook Development\n*(Adapted from 'Who plays a role in playbook development?')*\n\n* **Security & Risk Management Professionals:** CISO, CTO, CAE, CIO, CCO, CSO, IT & security operations teams.\n* **Finance:** Discuss ransom payment options (including crypto) and prioritize decisions based on circumstance and business priorities.\n* **Legal Counsel:** Provide guidance on law enforcement engagement and documentation requirements in compliance with federal agencies and customer reporting.\n* **Procurement:** Communicate existing cyber insurance coverages and assist with onboarding if needed.\n* **Communications:** Develop a plan for internal and external communication (before, during, and after an incident).\n\n</s>"
  },
  {
    "text": "<s>[INST] <<SYS>>\nYou are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident\n<</SYS>>\n\nPlease generate a Ransomware Incident Response Playbook? [/INST] Sure. Here is the information requested.\nTitle: : Incident Response Playbook for Ransomware Infection (NIST Compliant)\n1. Preparation: : Objective: To prepare for a potential ransomware attack by establishing an incident response plan and conducting initial assessments.\n\n\nStep-by-Step Guidance:\n\n1. Develop an incident response plan that includes roles and responsibilities, communication protocols, and procedures for reporting and responding to ransomware attacks.\n2. Identify critical systems and data that need to be protected and prioritize their backup and recovery.\n3. Conduct a baseline assessment of the current security posture to identify vulnerabilities and areas for improvement.\n4. Develop a list of trusted sources for threat intelligence and stay informed about the latest ransomware trends and tactics.\n2. Detection and Analysis: : Objective: To quickly identify and analyze a ransomware attack to determine its scope and impact.\n\nStep-by-Step Guidance:\n\n1. Implement monitoring tools to detect and alert on suspicious activity, such as unusual network traffic or file access.\n2. Conduct regular system scans to identify any unauthorized access or changes to systems and data.\n3. Establish a process for reporting and triaging incidents, including escalation procedures for critical incidents.\n4. Use incident response kits and checklists to guide analysts through the analysis process.\n5. Utilize threat intelligence feeds to inform analysis and identify the source of the attack.\n3. Containment: : Objective: To isolate and contain the ransomware attack to prevent further damage and limit the spread of the attack.\n\nStep-by-Step Guidance:\n\n1. Identify the affected systems and networks and isolate them from the rest of the network to prevent the attack from spreading.\n2. Implement a backup and recovery plan to restore affected systems and data.\n3. Conduct a thorough analysis of the attack to identify the initial entry point and the tactics, techniques, and procedures (TTPs) used by the attackers.\n4. Utilize incident response kits and checklists to guide analysts through the containment process.\n5. Consider the use of a \"ransomware kill switch\" to disable the attack if possible.\n4. Eradication: : Objective: To remove the ransomware from affected systems and networks.\n\nStep-by-Step Guidance:\n\n1. Implement a comprehensive response plan to remove the ransomware from affected systems and networks.\n2. Utilize anti-ransomware tools and software to remove the attack from affected systems.\n3. Conduct a thorough analysis of the attack to identify the TTPs used by the attackers and to improve the organization's defenses.\n4. Consider the use of a \"ransomware decryption tool\" to restore encrypted data.\n5. Document the incident and the steps taken to eradicate the attack for future reference.\n5. Recovery: : Objective: To restore affected systems and data to a known good state and to ensure business continuity.\n\nStep-by-Step Guidance:\n\n1. Develop a comprehensive recovery plan that includes procedures for restoring systems and data, as well as business continuity measures.\n2. Implement a backup and recovery plan to restore affected systems and data.\n3. Conduct a thorough analysis of the attack to identify the root cause and to improve the organization's defenses.\n4. Consider the use of a \"ransomware recovery tool\" to restore encrypted data.\n5. Document the incident and the steps taken to recover affected systems and data for future reference.\n6. Lessons Learned: : Objective: To document the incident and the response, and to identify areas for improvement in the incident response plan and the organization's overall security posture.\n\nStep-by-Step Guidance:\n\n1. Conduct a thorough post-incident review (PIR) to document the incident and the response.\n2. Identify the root cause of the incident and the TTPs used by the attackers.\n3. Document lessons learned and areas for improvement in the incident response plan and the organization's overall security posture.\n4. Utilize the incident response plan to improve the organization's defenses and to prevent similar incidents from occurring in the future.\n5. Share lessons learned with the organization and the broader security community to improve the overall security posture of the industry.</s>\n\n"
  },
  {
    "text": "<s>[INST] <<SYS>>\nYou are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident\n<</SYS>>\n\nPlease generate an incident response playbook for Locker Ransomware in an OT Environment? [/INST] Sure. Here is the information requested.\nTitle: : Incident Response Playbook: Locker Ransomware in an OT Environment (NIST Compliant)\n1. Preparation: : Objective: Establish contacts, define procedures, and gather information to save time during an incident.\n1.1 Knowledge Requirements\nSecurity Policies: Ensure comprehensive understanding of security policies for operating systems and user profiles specific to OT systems.\nNetwork Architecture: Familiarize with architecture, VLAN segmentation, and interconnections within the OT environment to enable isolation of entities, regions, partners, or the Internet.\n1.2 Security Product Updates\nRegular Updates: Ensure that all security products, including endpoint and perimeter defenses (email gateway, proxy caches), are regularly updated to the latest versions.\n1.3 Endpoint Protection Deployment\nDeployment: Implement endpoint protection solutions on all endpoints and servers within the OT environment.\nFunctionality: Use these solutions for identifying, containing, and remediating ransomware attacks. Configure policies to block identified threats.\n1.4 IT Support Awareness\nAwareness Training: Conduct regular training sessions for IT and OT support staff to recognize ransomware threats and report suspicious activities promptly.\n1.5 Block IOCs\nIOC Blocking: Use threat intelligence to identify and block IOCs associated with ransomware activities.\n1.6 Security Solutions Deployment\nDetection Tools: Deploy security solutions for detection and response, such as SIEM for log gathering, and tools like YARA or DFIR-ORC (ANSSI).\n1.7 Log Management\nLog Retention: Ensure comprehensive log retention and verbosity to aid in incident detection and forensic analysis.\n1.8 Posture and Communication\nPosture Definition: Define a strict stance against attackers and prepare an internal and external communication strategy.\n1.9 Communication Protocols\nEstablish Protocols: Define clear communication methods for the incident response team, stakeholders, and the public to ensure effective coordination during an incident.\n1.10 Backups Preparation\nBackup Strategy: Ensure exhaustive, recent, and reliable backups of local and network data, following the 3-2-1 backup rule (three copies, two formats, one offsite).\nOffline Backup: Maintain at least one backup format stored offline to protect against lateral movement.\n2. Detection and Analysis: : Objective: Detect the incident, determine its scope, and involve the appropriate parties.\n2.1 General Signs of Locker Ransomware Presence\nIndicators:\nUser reports of being locked out of their systems.\nDisplayed ransom messages on locked screens demanding payment for unlocking.\nInability to access critical OT systems or control interfaces.\nReports of unusual system behavior or changes in system functionality.\n2.2 Immediate Response\nIsolation: Physically isolate the affected machines from the network to prevent further spread.\nNotification: Immediately notify the incident response team and relevant stakeholders.\nDocumentation: Document the symptoms and any ransom messages for further analysis.\n2.3 Scoping of the Incident\nScope Determination: Use endpoint protection and monitoring tools to identify all affected systems.\nAsset Inventory: Identify and prioritize critical OT systems affected by the ransomware.\n2.4 Threat Actor Identification\nThreat Actor ID: Identify the threat actor to leverage known TTPs for planning the response.\n3. Containment: : Objective: Mitigate the attack’s effects on the targeted environment.\n3.1 Public Statement\nCommunication: Issue a public statement based on pre-prepared templates to inform stakeholders and the public about the incident.\n3.2 Follow Defined Posture\nPosture Adherence: Implement the predefined stance against the attackers as established during the preparation phase.\n3.3 Security Provider Actions\nSample Submission: Send undetected samples to endpoint security providers and/or private sandboxes.\nBlock Threats: Block communication with C2 servers and malicious IPs, URLs, and domains identified during the incident.\n3.4 Isolation\nNetwork Isolation: Isolate compromised VLANs, entities, and regions to prevent the spread of ransomware.\nAccount Management: Disable accounts compromised or created by attackers.\nDevice Disconnection: Disconnect compromised computers from the network and shared drives. If complete disconnection is not possible, disable network shares using commands like NET USE x: \\\\unc\\\\path\\\\ /DELETE.\nMonitor Data Leaks: Monitor ransomware threat actor websites for data leak publications.\n4. Eradication: : Objective: Take actions to remove the threat and avoid future incidents.\n4.1 Remove Threat\nInitial Access Removal:\nIdentify and close vulnerabilities or security gaps used by attackers.\nApply the latest security patches to affected systems.\nReview and update firewall rules and configurations.\nBinary Removal:\nUse endpoint protection tools and antivirus software to scan for and remove malicious binaries.\nPerform deep scans to ensure no residual malware remains.\nAccount Management:\nDisable and remove accounts created by attackers.\nRevert unauthorized changes to existing accounts.\nEnforce strong password policies and multi-factor authentication (MFA).\nConfiguration Reversion:\nRevert unauthorized configuration changes made by attackers.\nRestore system configurations to known good states using documented baselines.\nSystem and Network Hardening:\nDisable unnecessary services and ports, apply security patches, and enforce least privilege principles.\nEnsure proper network segmentation to limit the spread of future attacks.\nImplement network access control (NAC) to enforce security policies on connected devices.\nThird-Party and Vendor Assessment:\nReview third-party connections and vendor access to the network.\nImplement stricter controls and monitoring for third-party access.\nEnsure third-party services and software are up to date and secure.\n4.2 Incident-Specific Remediation Actions\nIdentify and Mitigate Exploited Vulnerabilities:\nUse threat intelligence and vulnerability management tools to identify and patch vulnerabilities exploited during the attack.\nAdvanced Threat Detection:\nImplement IDS/IPS to monitor for attack techniques used during the incident.\nEnhance monitoring and alerting for abnormal activities related to the ransomware strain.\n4.3 Collaboration and Coordination\nEngage with Cybersecurity Experts:\nCollaborate with external cybersecurity experts or incident response teams for forensic analysis and threat eradication.\nShare Threat Intelligence:\nShare IOCs and attack details with industry groups and threat intelligence communities.\n4.4 Validation and Verification\nComprehensive Scans and Testing:\nConduct comprehensive scans and penetration tests to ensure no residual threats remain.\nVerification of System Integrity:\nUse integrity monitoring tools to verify the integrity of critical system files and configurations.\n4.5 Security Awareness and Training\nEmployee Education:\nConduct security awareness training sessions focusing on ransomware prevention, detection, and response.\nRegular Drills and Simulations:\nPerform regular incident response drills and tabletop exercises to ensure preparedness.\n4.6 Policy and Procedure Updates\nReview and Update Policies:\nUpdate security policies and procedures based on lessons learned.\nStrengthen Access Controls:\nImplement stronger access controls, such as RBAC, to minimize the risk of unauthorized access.\n4.7 Continuous Improvement\nPost-Incident Review:\nConduct a thorough post-incident review to identify areas for improvement.\nDocument lessons learned and update the incident response plan.\nImplement Feedback Loops:\nEstablish feedback loops to continuously improve detection, response, and remediation processes.\n5. Recovery: : Objective: Restore the system to normal operations.\n5.1 System Unlock and Restoration\nUnlock Systems: Use decryption keys if available or collaborate with security experts to unlock systems without paying the ransom.\nMalicious Binary Removal: Ensure all ransomware-related binaries are removed before system restoration.\n5.2 Document Restoration\nRestore Documents: Restore user documents from clean backups following the disaster recovery plan (DRP).\nStep-by-Step Recovery: Follow a structured recovery plan, prioritizing critical systems and continuously monitoring for issues.\n5.3 Backup Verification and System Reimaging\nVerify Backups: Ensure backups are clean before restoration. Reimage systems if necessary.\n5.4 Credential Reset\nReset Credentials: Change all credentials, especially for administrator and system accounts.\n5.5 Network Monitoring\nMonitor Traffic: Continuously monitor network traffic for residual infections and apply geo-filtering to block illegitimate foreign traffic.\nData Leak Monitoring: Maintain vigilance for any data leak publications related to the ransomware attack.\n6. Lessons Learned: : Objective: Document the incident’s details, discuss lessons learned, and adjust plans and defenses.\n6.1 Incident Report\nReport Creation: Document the incident’s details, including causes, actions, timelines, successes, failures, costs, and IOCs.\n6.2 Capitalize\nImprove Detection: Define actions to enhance malware and network intrusion detection processes based on the incident experience.\nUpdate Training: Integrate lessons learned into ongoing security training and awareness programs for staff.</s>\n\n"
  },
  {
    "text": "<s>[INST] <<SYS>>\nYou are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident\n<</SYS>>\n\nPlease generate an incident response playbook for ransomware attack in OT environment? [/INST] Sure. Here is the information requested.\nTitle: : Incident Response Playbook for Ransomware Infection\n1. Preparation: : Objective: Establish contacts, define procedures, gather information to save time during an incident.\n1.1 Knowledge Requirements\nSecurity Policies: Ensure comprehensive understanding of security policies for operating systems and user profiles.\nNetwork Architecture: Familiarize with architecture, VLAN segmentation, and interconnections to enable isolation of entities, regions, partners, or the Internet.\n1.2 Security Product Updates\nRegular Updates: Ensure endpoint and perimeter security products (email gateway, proxy caches) are up to date.\n1.3 EDR Solution Deployment\nDeployment: Implement EDR solutions on endpoints and servers.\nFunctionality: Use EDR for identification, containment, and remediation. Launch EDR searches and AV scans with IOC rules for progress indicators.\nPolicies: Set EDR policies to prevent mode.\n1.4 IT Support Awareness\nAwareness Training: Educate IT support on ransomware threats and detection.\n1.5 Block IOCs\nIOC Blocking: Block IOCs linked to ransomware activities using Threat Intelligence.\n1.6 Security Solutions Deployment\nDetection Tools: Deploy security solutions for detection and response, such as SIEM for log gathering and tools like YARA or DFIR-ORC (ANSSI).\n1.7 Log Management\nLog Retention: Maintain comprehensive log retention and verbosity.\n1.8 Posture and Communication\nPosture Definition: Define a strict posture against attackers.\nCommunication Strategy: Prepare internal and external communication plans.\n1.9 Communication Protocols\nEstablish Protocols: Define communication methods for the incident response team, stakeholders, and the public.\n1.10 Backups Preparation\nBackup Strategy: Ensure exhaustive, recent, and reliable backups of local and network data.\n3-2-1 Rule: Maintain three copies in two different formats, with one offsite. Use one backup format stored off the network.\n2. Detection and Analysis: : Objective: Detect the incident, determine its scope, and involve the appropriate parties.\n2.1 General Signs of Ransomware Presence\nIndicators:\nMonitoring of ransomware IOCs by SOC.\nSupervision of EDR alerts.\nOdd emails with suspicious attachments.\nRansom messages on desktops.\nFile availability issues with unusual extensions.\nRapid file modifications on network shares.\nData leak publications by ransomware operators.\nUnusual network activity or web Browse.\n2.2 Immediate Response\nIsolation: Unplug infected machines from the network and keep them on for memory forensics.\n2.3 Scoping of the Incident\nScope Determination: Use EDR, YARA, or DFIR-ORC to identify ransomware-infected machines and the attack's initial access point.\n2.4 Threat Actor Identification\nThreat Actor ID: Identify the threat actor to leverage known TTPs for response planning.\n3. Containment: : Objective: Mitigate the attack’s effects on the targeted environment.\n3.2 Follow Defined Posture\nPosture Adherence: Implement the predefined posture from the preparation phase.\n3.3 Security Provider Actions\nSample Submission: Send undetected samples to security providers.\nBlock Threats: Block C2 traffic, malicious IPs, URLs, and domains.\n3.4 Isolation\nNetwork Isolation: Isolate compromised VLANs, entities, and partners. Disable compromised accounts.\nDisconnect Devices: Disconnect compromised computers from the network and shared drives.\nMonitor for Data Leaks: Keep an eye on ransomware threat actor websites for data leak publications.\n3.5 Public Statement\nCommunication: Issue a public statement based on pre-prepared templates.\n4. Eradication: : Objective: Take actions to remove the threat and avoid future incidents.\n4.1 Remove Threat\nInitial Access Removal:\nIdentify and close any vulnerabilities or security gaps used by attackers to gain initial access.\nPatch all affected systems with the latest security updates.\nReview and update firewall rules and configurations to prevent unauthorized access.\nBinary Removal:\nUse EDR tools and antivirus software to scan for and remove malicious binaries and tools used by attackers.\nPerform deep scans on all systems to ensure no residual malicious software remains.\nAccount Management:\nDisable and remove any accounts created by the attackers.\nReview and remove any unauthorized changes to existing accounts, such as added privileges.\nEnforce strong password policies and multi-factor authentication (MFA) for all accounts.\nConfiguration Reversion:\nRevert any unauthorized configuration changes made by attackers.\nRestore system configurations to known good states using documented baselines.\nSystem and Network Hardening:\nImplement hardening measures across all systems and network devices. This includes disabling unnecessary services and ports, applying security patches, and enforcing least privilege principles.\nEnsure proper network segmentation to limit the spread of potential future attacks.\nUse network access control (NAC) to enforce security policies on devices trying to access the network.\nThird-Party and Vendor Assessment:\nConduct a thorough review of third-party connections and vendor access to the network.\nImplement stricter controls and monitoring for third-party access.\nEnsure all third-party services and software are up to date and secure.\n4.2 Incident-Specific Remediation Actions\nIdentify and Mitigate Exploited Vulnerabilities:\nUse threat intelligence and vulnerability management tools to identify vulnerabilities exploited during the attack.\nPrioritize and apply patches to mitigate these vulnerabilities across all systems.\nAdvanced Threat Detection:\nImplement advanced threat detection solutions, such as intrusion detection/prevention systems (IDS/IPS), to monitor for signs of attack techniques used during the incident.\nEnhance monitoring and alerting for abnormal activities related to the specific ransomware strain.\n4.3 Collaboration and Coordination\nEngage with Cybersecurity Experts:\nCollaborate with external cybersecurity experts or incident response teams to gain insights and assistance in threat removal and remediation.\nUtilize their expertise to conduct thorough forensics and ensure complete eradication of threats.\nShare Threat Intelligence:\nShare IOCs and attack details with relevant industry groups and threat intelligence communities to aid in broader defense efforts.\nStay updated with threat intelligence feeds to quickly react to new threats and indicators.\n4.4 Validation and Verification\nComprehensive Scans and Testing:\nConduct comprehensive scans and penetration tests to ensure no residual threats remain.\nValidate that all systems are free from malware and unauthorized modifications.\nVerification of System Integrity:\nUtilize integrity monitoring tools to verify the integrity of critical system files and configurations.\nRegularly compare current system states with known good baselines to detect and remediate unauthorized changes.\n4.5 Security Awareness and Training\nEmployee Education:\nConduct security awareness training sessions focusing on ransomware prevention, detection, and response.\nEnsure employees understand the importance of reporting suspicious activities and adhering to security policies.\nRegular Drills and Simulations:\nPerform regular incident response drills and tabletop exercises to ensure the team is prepared for future incidents.\nSimulate ransomware attack scenarios to practice detection, containment, and remediation steps.\n4.6 Policy and Procedure Updates\nReview and Update Policies:\nReview and update security policies and procedures based on lessons learned from the incident.\nEnsure policies reflect current best practices and address any gaps identified during the response.\nStrengthen Access Controls:\nImplement stronger access controls, such as role-based access control (RBAC), to minimize the risk of unauthorized access.\nRegularly review and update access permissions to ensure they align with the principle of least privilege.\n4.7 Continuous Improvement\nPost-Incident Review:\nConduct a thorough post-incident review to identify areas for improvement.\nDocument lessons learned and incorporate them into the organization's incident response plan.\nImplement Feedback Loops:\nEstablish feedback loops to continuously improve detection, response, and remediation processes.\nRegularly review and refine incident response strategies to stay ahead of evolving threats.\n5. Recovery: : Objective: Restore the system to normal operations.\n5.1 Antivirus and Malicious Binaries\nUpdate AV: Ensure antivirus signatures are updated and malicious binaries are removed.\n5.2 Document Restoration\nRestore Documents: Restore user documents from clean backups following the DRP.\n5.3 Backup Verification and System Reimaging\nVerify Backups: Ensure backups are clean before restoration. Reimage systems if necessary.\n5.4 Credential Reset\nReset Credentials: Change all credentials, especially for administrator and system accounts.\n5.5 Network Monitoring\nMonitor Traffic: Continuously monitor network traffic for residual infections and apply geo-filtering.\n6. Lessons Learned: : Objective: Document the incident’s details, discuss lessons learned, and adjust plans and defenses.\n6.1 Incident Report\nReport Creation: Document the incident’s details, including causes, actions, timelines, successes, failures, costs, and IOCs.\n6.2 Capitalize\nImprove Detection: Define actions to enhance malware and network intrusion detection processes based on the incident experience</s>\n\n"
  },
  {
    "text": "<s>[INST] <<SYS>>\nYou are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident\n<</SYS>>\n\nPlease generate a incident response playbook to respond a ransomware attack? [/INST] Sure. Here is the information requested.\nTitle: : Incident Response Playbook for Ransomware Infection (NIST Compliant)\n1. Preparation: : Objective: Establish contacts, define procedures, gather information to save time during an incident. \n1.1 Develop and Maintain Policies:\nEnsure all relevant policies are documented and reviewed regularly.\nEstablish an incident response policy that includes ransomware.\n1.2 Identify Critical Assets:\nMaintain an updated inventory of critical systems and data.\nPrioritize assets based on business impact analysis.\n1.3 Conduct Training and Awareness:\nRegularly train staff on ransomware threats and incident response procedures.\nConduct phishing simulations and other exercises to prepare users.\n1.4 Establish Incident Response Team (IRT):\nDefine roles and responsibilities within the IRT.\nEnsure the IRT is trained and familiar with the ransomware response playbook.\n1.5 Deploy and Configure Tools:\nEnsure tools for detection, analysis, containment, and eradication are in place and configured.\nRegularly update antivirus, EDR, and backup solutions.\n2. Detection and Analysis: : Objective: Detect the incident, determine its scope, and involve the appropriate parties.\n2.1 Determine the type of ransomware\nFind any related messages. Check:\nGraphical user interfaces (GUIs) for the malware itself.\nText or HTML files, sometimes opened automatically after encryption.\nImage files, often as wallpaper on infected systems.\nContact emails in encrypted file extensions.\nPop-ups after trying to open an encrypted file.\nVoice messages.\nAnalyze the messages looking for clues to the ransomware type:\nRansomware name.\nLanguage, structure, phrases, artwork.\nContact email.\nFormat of the user ID.\nRansom demand specifics.\nPayment address in case of digital currency.\nSupport chat or support page.\nAnalyze affected and/or new files. Check:\nFile renaming scheme of encrypted files including extension and base name.\nFile corruption vs encryption.\nTargeted file types and locations.\nOwning user/group of affected files.\nIcon for encrypted files.\nFile markers.\nExistence of file listings, key files, or other data files.\nAnalyze affected software or system types.\nUpload indicators to automated categorization services like Crypto Sheriff, ID Ransomware, or similar.\n2.2 Determine the scope:\nWhich systems are affected?\nScan for concrete indicators of compromise (IOCs) such as files/hashes, processes, network connections, etc. Use endpoint protection/EDR, endpoint telemetry, system logs, etc.\nCheck similar systems for infection: check IAM tools, permissions management tools, directory services, etc.\nFind external command and control (C2), if present, and find other systems connecting to it: check firewall or IDS logs, system logs/EDR, DNS logs, netflow or router logs, etc.\nWhat data is affected?\nFind anomalous changes to file metadata such as mass changes to creation or modification times. Check file metadata search tools.\nFind changes to normally-stable or critical data files. Check file integrity monitoring tools.\n2.3 Assess the impact to prioritize and motivate resources\nAssess functional impact: impact to business or mission.\nHow much money is lost or at risk?\nHow many (and which) missions are degraded or at risk?\nAssess information impact: impact to confidentiality, integrity, and availability of data.\nHow critical is the data to the business/mission?\nHow sensitive is the data?\nWhat is the regulatory status of data?\n2.4 Find the infection vector\nCheck the tactics captured in the Initial Access tactic of MITRE ATT&CK. Common specifics and data sources include:\nEmail attachment: check email logs, email security appliances and services, e-discovery tools, etc.\nInsecure remote desktop protocol (RDP): check vulnerability scanning results, firewall configurations, etc.\nSelf-propagation (worm or virus) (check host telemetry/EDR, system logs, forensic analysis, etc.)\nInfection via removable drives (worm or virus)\nDelivered by other malware or attacker tool: expand investigation to include additional attacker tools or malware.\n2.5 Communication\nNotify senior leadership about the potential ransomware incident.\nProvide initial findings and potential impacts.\nEnsure all detection and analysis activities are documented.\nRecord details of the ransomware type, scope of impact, and initial response steps.\nDiscuss legal implications, compliance requirements, and potential liabilities.\nDetermine the need for law enforcement involvement.\n3. Containment: : Objective: Mitigate the attack’s effects on the targeted environment.\n3.1 Immediate Containment:\nDisconnect affected systems from the network.\nQuarantine impacted user accounts and groups.\nBlock malicious IPs, domains, and C2 servers.\n3.2 Quarantine Steps:\nQuarantine infected systems.\nQuarantine affected users and groups.\nQuarantine file shares and shared databases.\nQuarantine backups, if not already secured.\nBlock command and control domains and addresses.\nRemove vector emails from inboxes.\nConfirm endpoint protection is up-to-date and enabled on all systems.\nConfirm patches are deployed on all systems.\nDeploy custom signatures to endpoint protection and network security tools based on discovered IOCs.\nConsider automating containment measures using orchestration tools.\n3.3 Communication:\nInform affected users about containment actions and expected disruptions.\nProvide guidance on steps for users need to take to prevent further spread.\nRegularly update stakeholders on containment progress.\nHighlight any challenges and additional containment measures being implemented.\nExplain why certain systems or services are down.\nProvide timelines for restoration and additional containment measures.\n4. Eradication: : Objective: Take actions to remove the threat and avoid future incidents.\n4.1 Remediation Steps:\nPlan remediation events where these steps are launched together (or in coordinated fashion), with appropriate teams ready to respond to any disruption.\nConsider the timing and tradeoffs of remediation actions: your response has consequences.\nRebuild infected systems from known-good media.\nRestore from known-clean backups.\nConfirm endpoint protection is up-to-date and enabled on all systems.\nConfirm patches are deployed on all systems.\nDeploy custom signatures to endpoint protection and network security tools based on discovered IOCs.\nWatch for re-infection: consider increased priority for alarms/alerts related to this incident.\nProvide updates to users on eradication progress and timelines for system restoration.\n5. Recovery: : Objective: Restore the system to normal operations.\n5.1 Steps:\nLaunch business continuity/disaster recovery plan(s): e.g., consider migration to alternate operating locations, fail-over sites, backup systems.\nRecover data from known-clean backups to known-clean, patched, monitored systems (post-eradication).\nCheck backups for indicators of compromise.\nConsider partial recovery and backup integrity testing.\nFind and try known decryptors for the variant(s) discovered using resources like the No More Ransom! Project's Decryption Tools page.\nConsider paying the ransom for irrecoverable critical assets/data, in accordance with policy (e.g., finance, legal, regulatory, insurance). Do not recommend paying the ransom: it does not guarantee a solution to the problem.\nConsider ramifications with appropriate stakeholders.\nUnderstand finance implications and budget.\nUnderstand legal, regulatory, and insurance implications.\nUnderstand mechanisms (e.g., technologies, platforms, intermediate vendors/go-betweens).\n5.2 Generate required notifications based on applicable regulations:\nPrepare notifications for regulators, especially if ransomware constitutes a data breach.\nEnsure compliance with notification timelines and content requirements.\n6. Lessons Learned: : Objective: Document the incident’s details, discuss lessons learned, and adjust plans and defenses.\n6.1 Lessons Learned:\nConduct a post-incident review to identify gaps and improvements.\nUpdate the incident response playbook based on findings.\n6.2 Report and Document:\nCompile a detailed incident report.\nEnsure all incident documentation is complete and stored securely.\n6.3 Improve Defenses:\nImplement additional security controls as needed.\nReview and enhance backup and recovery procedures.\n\n\n7. Additional Contents\n7.1 Tools and Resources:\nDetection Tools: SIEM, EDR, antivirus, and IDS/IPS solutions.\nAnalysis Tools: Forensic analysis tools, ID Ransomware, Crypto Sheriff.\nContainment Tools: Network segmentation, firewall rules, quarantine procedures.</s>\n\n"
  }
]

[
  {
    "text": "<s>[INST] <<SYS>>\nYou are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident\n<</SYS>>\n\nPlease provide a incident response playbook for SQL Injection and Command Injection? [/INST] Sure. Here is the information requested.\nTitle: : SQL Injection and Command Injection Incident Response Playbook\n1. Preparation: : Objective: Establish Contacts, Define Procedures, Gather Information to Save Time During an Incident\nIdentify Critical Applications:\nDocumentation: Maintain an up-to-date inventory of all OT applications, web interfaces, and APIs that interact with databases or execute commands. Include details about the technology stack and configurations.\nPrioritization: Assign criticality levels to these applications based on their role in operations and potential impact of an injection attack.\nSecurity Assessments:\nRegular Vulnerability Scans: Schedule regular vulnerability scans and penetration tests focusing on SQL injection and command injection vulnerabilities.\nCode Reviews: Conduct regular code reviews to ensure that input validation and output encoding are properly implemented.\nPatch Management: Implement a robust patch management process to ensure timely application of security patches and updates.\nIncident Response Team (IRT):\nTeam Formation: Form a dedicated IRT with members from IT, OT, and cybersecurity departments. Include roles such as incident commander, database administrators, application security experts, and communication leads.\nRoles and Responsibilities: Define clear roles and responsibilities for each team member, ensuring redundancy in critical roles.\nTraining:\nRegular Training: Conduct regular training sessions on identifying and responding to SQL injection and command injection attacks. Use simulation drills and tabletop exercises.\nSecure Coding Practices: Train developers and engineers on secure coding practices to prevent injection vulnerabilities.\nTools:\nWeb Application Firewalls (WAF): Deploy WAFs to protect web applications from SQL injection and command injection attacks.\nDatabase Activity Monitoring (DAM): Use DAM tools to monitor and log database activities for anomalies.\nIntrusion Detection Systems (IDS): Deploy IDS to detect malicious activities related to injection attacks.\n2. Detection and Analysis: : Anomaly Detection:\nBehavioral Analytics: Use behavioral analytics to detect deviations from normal application usage patterns, such as unusual database queries or command executions.\nThreshold Alerts: Configure alerts for unusual activity like a high number of database queries or commands executed in a short time frame.\nLog Monitoring:\nContinuous Monitoring: Continuously monitor and analyze logs from applications, databases, and servers for signs of SQL injection and command injection attacks.\nLog Correlation: Use log correlation tools to link related events and identify patterns indicative of an injection attack.\nReal-Time Alerts:\nSIEM Integration: Integrate logs from all relevant systems with a SIEM system for centralized monitoring and real-time alerting.\nAlert Prioritization: Configure SIEM to prioritize alerts based on the severity and potential impact on critical applications and systems.\nIncident Categorization:\nAttack Identification: Determine the type of injection attack (SQL injection or command injection) by analyzing the symptoms and attack patterns.\nScope Determination: Assess the extent of the attack, including affected applications, databases, and systems.\nImpact Assessment:\nOperational Impact: Evaluate the impact on OT operations, including potential data breaches, unauthorized command executions, and downtime.\nResource Utilization: Assess the utilization of system resources such as CPU, memory, and network bandwidth during the attack.\nSource Identification:\nIP Tracking: Identify the IP addresses involved in the attack, using geolocation tools to determine the geographical origin of the traffic.\nPayload Analysis: Analyze the injected SQL queries or commands to understand the attacker's intent and objectives.\n3. Containment: : Objective: Mitigate the Attack’s Effects on the Targeted Environment\nTraffic Filtering:\nWAF Rules: Apply specific WAF rules to filter out malicious traffic based on the attack patterns identified.\nIP Blacklisting: Block IP addresses identified as sources of the attack at the firewall or router level.\nRate Limiting:\nTraffic Throttling: Apply rate limiting on network devices to control the flow of suspicious traffic and prevent overwhelming system resources.\nAdaptive Controls: Use adaptive rate limiting that adjusts thresholds based on real-time traffic analysis.\nAccess Control:\nRestrict Access: Temporarily restrict access to affected applications and endpoints to prevent further impact.\nEnhanced Authentication: Implement multi-factor authentication (MFA) and other enhanced access controls for critical applications.\n4. Eradication: : Mitigation Tools:\nDatabase Security Tools: Use database security tools to scan and fix vulnerabilities, ensuring databases are configured securely.\nCommand Execution Controls: Implement controls to restrict the execution of potentially dangerous commands on servers.\nPatch and Update:\nVulnerability Patching: Apply patches and updates to affected applications and systems to close vulnerabilities exploited during the attack.\nSecurity Updates: Ensure all security updates are applied to underlying systems, libraries, and dependencies.\n5. Recovery: : Objective: Restore the System to Normal Operations\n\nSystem Checks:\nIntegrity Verification: Perform thorough checks to ensure all applications and systems are functioning correctly and are free of malicious activity.\nHealth Monitoring: Monitor the health of applications and databases using performance and security metrics.\nTraffic Normalization:\nGradual Restoration: Gradually restore normal traffic flow while closely monitoring for any residual malicious activity.\nBaseline Comparison: Compare current traffic patterns with established baselines to detect anomalies.\nData Integrity:\nData Verification: Verify the integrity of application data and configurations to ensure no tampering occurred.\nBackup Restoration: Restore data from secure backups if any corruption or loss is detected.\n6. Lessons Learned: : Objective: Document the Incident’s Details, Discuss Lessons Learned, and Adjust Plans and Defenses\nDocumentation:\nIncident Report: Document the incident comprehensively, including the type of attack, detection methods, response actions, timeline, and impact assessment.\nLessons Learned: Record lessons learned and any gaps identified in the response process.\nReview and Improve:\nPost-Incident Review: Conduct a thorough review of the incident with the IRT and other stakeholders. Discuss what went well and areas for improvement.\nPlan Updates: Update the IR plan based on findings and recommendations from the review.\nTraining Update:\nIncorporate Learnings: Integrate new knowledge and lessons learned into training programs. Ensure all relevant personnel are aware of the updates.\nOngoing Training: Schedule regular training and awareness sessions to keep the team prepared for future incidents.</s>\n\n"
  },
  {
    "text": "<s>[INST] <<SYS>>\nYou are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident\n<</SYS>>\n\nPlease provide a incident response playbook for SQL Injection and Command Injection? [/INST] Sure. Here is the information requested.\nTitle: : SQL Injection and Command Injection Incident Response Playbook\n1. Preparation: : Objective: Establish Contacts, Define Procedures, Gather Information to Save Time During an Incident\nIdentify Critical Applications:\nDocumentation: Maintain an inventory of all OT applications, databases, web interfaces, and APIs. This should include details about the technology stack, versions, configurations, and any custom-developed components.\nPrioritization: Assign criticality levels to each application based on their role in OT operations. Focus on those that have direct control over industrial processes or sensitive data.\nSecurity Assessments:\nRegular Vulnerability Scans: Schedule and conduct vulnerability scans using tools like OWASP ZAP, Nessus, or Burp Suite to identify potential SQL and command injection points.\nCode Reviews: Perform code reviews focusing on input validation and output encoding. Use automated tools like SonarQube combined with manual reviews by experienced developers.\nPatch Management: Implement a robust patch management process. Regularly update software, databases, and dependencies to the latest secure versions.\nIncident Response Team (IRT):\nTeam Formation: Form a team with roles including an incident commander, network security specialist, database administrator, application security expert, and communication officer.\nRoles and Responsibilities: Clearly define and document roles. Ensure all team members understand their responsibilities during an incident.\nTraining:\nRegular Training: Conduct regular training sessions, including workshops on identifying injection attacks and hands-on response exercises.\nSecure Coding Practices: Train developers on secure coding practices, emphasizing input validation, parameterized queries, and least privilege principles.\nTools:\nWeb Application Firewalls (WAF): Deploy WAFs to detect and block SQL and command injection attempts. Configure them to alert and block based on signatures and behavioral analysis.\nDatabase Activity Monitoring (DAM): Use DAM tools to monitor database activities and set up alerts for unusual queries or patterns.\nIntrusion Detection Systems (IDS): Deploy IDS to monitor network traffic for signs of injection attacks.\n2. Detection and Analysis: : Anomaly Detection:\nBehavioral Analytics: Implement tools that use machine learning to detect deviations from normal database and application usage patterns.\nThreshold Alerts: Set thresholds for normal database query volumes and execution times. Alerts should trigger for abnormal activity, such as a sudden increase in the number of queries.\nLog Monitoring:\nContinuous Monitoring: Continuously monitor logs from applications, databases, web servers, and network devices.\nLog Analysis: Use tools like ELK Stack (Elasticsearch, Logstash, Kibana) to aggregate and analyze logs. Look for patterns indicating SQL or command injection attempts, such as repeated use of keywords like SELECT, DROP, INSERT, or command shell execution.\nReal-Time Alerts:\nSIEM Integration: Integrate all logs with a Security Information and Event Management (SIEM) system. Configure real-time alerts for detected anomalies or suspicious activities.\nAlert Prioritization: Ensure alerts are prioritized based on their potential impact on critical OT operations. High-severity alerts should trigger immediate investigation.\nIncident Categorization:\nAttack Identification: Use log data, WAF alerts, and database activity reports to identify the type of injection attack. SQL injection often shows up as malformed SQL queries, while command injection involves unauthorized shell commands.\nScope Determination: Determine the scope by identifying affected applications, databases, and endpoints. Use network flow data to map the extent of the attack.\nImpact Assessment:\nOperational Impact: Assess the immediate impact on OT operations, including system downtime, data integrity, and the potential for unauthorized command execution.\nResource Utilization: Check resource utilization metrics for affected systems to determine if the attack is causing performance issues or service degradation.\nSource Identification:\nIP Tracking: Track the IP addresses associated with suspicious activity. Use geolocation tools to identify their origin and cross-reference with known threat intelligence databases.\nPayload Analysis: Analyze the injected queries or commands to understand the attacker's intent and the potential damage.\n3. Containment: : Objective: Mitigate the Attack’s Effects on the Targeted Environment\n\nTraffic Filtering:\nWAF Rules: Update WAF rules to block the identified injection patterns. Use virtual patching to mitigate vulnerabilities until a proper fix can be deployed.\nIP Blacklisting: Blacklist IP addresses involved in the attack at the firewall level. Ensure this does not disrupt legitimate traffic.\nRate Limiting:\nTraffic Throttling: Implement rate limiting on critical endpoints to slow down potential attackers and reduce the impact of automated attacks.\nAdaptive Rate Limiting: Use adaptive rate limiting to dynamically adjust based on real-time traffic analysis, ensuring legitimate operations are not hindered.\nAccess Control:\nRestrict Access: Temporarily restrict access to affected systems and endpoints. Implement emergency access controls and revoke unnecessary privileges.\nEnhanced Authentication: Enforce multi-factor authentication (MFA) for accessing critical applications and systems.\n4. Eradication: : Mitigation Tools:\nDatabase Security Tools: Use tools to scan for and fix SQL injection vulnerabilities. Ensure databases are configured securely with minimal permissions.\nCommand Execution Controls: Implement controls to restrict unauthorized command execution, such as using sudo restrictions and limiting shell access.\nPatch and Update:\nVulnerability Patching: Apply patches and updates to fix identified vulnerabilities. Ensure that application frameworks, libraries, and dependencies are also updated.\nSecurity Updates: Regularly apply security updates to all systems involved, including databases, application servers, and network devices.\n5. Recovery: : Objective: Restore the System to Normal Operations\nSystem Checks:\nIntegrity Verification: Perform comprehensive checks to ensure all systems and applications are functioning correctly and are free of malicious activity. Verify that database schemas and data have not been tampered with.\nHealth Monitoring: Monitor system health using performance and security metrics to ensure stability.\nTraffic Normalization:\nGradual Restoration: Gradually restore normal traffic flow while monitoring for any residual malicious activity. Implement phased recovery to ensure stability.\nBaseline Comparison: Continuously compare current traffic patterns with established baselines to detect any anomalies.\nData Integrity:\nData Verification: Verify the integrity of application data and configurations. Conduct database audits to check for unauthorized changes.\nBackup Restoration: If any data corruption or loss is detected, restore data from secure backups. Ensure backups are recent and not compromised.\n6. Lessons Learned: : Objective: Document the Incident’s Details, Discuss Lessons Learned, and Adjust Plans and Defenses\nDocumentation:\nIncident Report: Create a detailed incident report covering the type of attack, detection methods, response actions, timeline, and impact assessment. Include a summary of what was learned.\nLessons Learned: Document lessons learned, focusing on the root causes and gaps in the response process.\nReview and Improve:\nPost-Incident Review: Conduct a comprehensive review of the incident with the IRT and relevant stakeholders. Analyze the effectiveness of the response and identify areas for improvement.\nPlan Updates: Update the IR plan based on findings and recommendations. Ensure the plan incorporates the latest best practices and threat intelligence.\nTraining Update:\nIncorporate Learnings: Integrate new knowledge and lessons learned into training programs. Ensure all relevant personnel are aware of the updates.\nOngoing Training: Schedule regular training and awareness sessions. Use updated scenarios from the incident to enhance future preparedness.</s>\n\n"
  },
  {
    "text": "<s>[INST] <<SYS>>\nYou are a helpful cybersecurity assistant that generates detailed incident response playbooks based on established industry guides and best practices.\n<</SYS>>\n\nPlease generate a playbook for an Advanced SQL Injection attack, including scenario, attack steps for simulation, and mitigation/remediation phases.\n[/INST] \n\n# Advanced SQL Injection Defense Playbook\n\n## Scenario: Fintech Innovations Inc.\n\nFintech Innovations Inc., a company in the financial technology sector with an online banking platform, discovered potential SQL injection vulnerabilities during a security audit. These pose a significant risk to customer financial data. This playbook outlines an exercise to assess readiness and improve defensive tactics against sophisticated SQL injection threats.\n\n## Playbook Objectives\n\n* To enhance the security posture of the organization by identifying and mitigating SQL injection vulnerabilities.\n* Equip the IT security team with the capabilities to detect, respond to, and neutralize SQL injection attacks effectively.\n* Ensure all web applications are secure against advanced SQL injection techniques.\n* Validate the effectiveness of current defenses and incident response procedures.\n\n## Simulated Attack Steps (for Exercise/Testing Purposes)\n\n### 1. Reconnaissance:\n* Gather information on Fintech Innovations Inc.’s online banking application, identifying entry points for SQL injection.\n* Enumerate database servers and web application versions to tailor the attack.\n\n### 2. Weaponization:\n* Create advanced SQL injection payloads aimed at bypassing typical input sanitization filters implemented in web applications.\n\n### 3. Delivery:\n* Deploy the crafted SQL injection payloads through web forms, search fields, and other user inputs on the application.\n\n### 4. Exploitation:\n* Successfully execute the SQL injection attack, targeting user authentication mechanisms and confidential data retrieval.\n* Escalate privileges within the database to gain unauthorized access to sensitive customer information.\n\n### 5. Post-Exploitation:\n* Extract data secured under normal operations demonstrating potential data loss.\n* Explore lateral movement possibilities to other parts of the network from the compromised database.\n\n### 6. Reporting (from Attacker Simulation Perspective):\n* Document the sequence of the attack and the exploitation technique used.\n* Identify which data could be exfiltrated or compromised.\n\n## Incident Response & Mitigation Phase\n\n### Preparation & Prevention (Proactive Measures from the Playbook)\n* Apply advanced input validation techniques and parameterized queries to secure web application vulnerabilities.\n* Implement comprehensive logging for web applications and databases.\n* Configure and maintain a Web Application Firewall (WAF) to detect and block SQL injection attempts.\n* Regularly audit and update legacy code components.\n* Conduct regular security audits and penetration testing exercises.\n* Provide security awareness training for developers and IT staff on advanced SQL injection prevention techniques.\n\n### Detection and Analysis (During a Real or Simulated Attack)\n* Monitor WAF logs, database logs, and application logs for suspicious SQL queries or patterns indicative of an attack.\n* Analyze failed login attempts or unusual data access patterns.\n* Use database activity monitoring (DAM) tools to identify anomalous behavior.\n\n### Containment\n* If an active attack is detected, immediately block the source IP addresses at the firewall or WAF.\n* Isolate affected database segments if possible, to prevent lateral movement.\n* Revoke compromised credentials if any are identified.\n* Temporarily disable vulnerable application features if they cannot be immediately patched.\n\n### Eradication\n* Identify and remediate the SQL injection vulnerability (e.g., patch code, update WAF rules).\n* Remove any backdoors or malicious scripts planted by the attacker.\n* Ensure all attacker-created accounts or escalated privileges are revoked.\n\n### Recovery\n* Restore any affected data from clean backups if data integrity was compromised (after ensuring the vulnerability is fixed).\n* Bring systems back online in a controlled manner, monitoring closely for any signs of re-infection or further attacks.\n* Validate that application functionality is restored and secure.\n\n### Lessons Learned (Post-Incident/Exercise)\n* Review the effectiveness of the defense mechanisms put in place.\n* Analyze the incident response process: what worked well, what could be improved.\n* Update the security awareness training for developers and IT staff to include lessons from this specific incident/exercise.\n* Plan for regular security audits and penetration testing exercises to ensure continual improvement of security posture.\n\nBy running this Advanced SQL Injection Defense Playbook exercise, Fintech Innovations Inc. aims to comprehensively fortify its network, protect its brand’s credibility, and safeguard its customers’ trust.\n\n</s>"
  }
]

[
  {
    "text": "<s>[INST] <<SYS>>\nYou are a helpful cybersecurity assistant that generates detailed incident response playbooks based on established industry guides and best practices, such as the Government of Alberta's data breach standard operating procedure.\n<</SYS>>\n\nPlease generate a comprehensive Data Breach Incident Response Playbook based on the CyberAlberta guide, covering assessment, response, and post-incident phases.\n[/INST] \n\n# Data Breach Playbook (Based on CyberAlberta Guide)\n\n## Overview\nA data breach is a security violation where sensitive, protected, or confidential data is copied, transmitted, viewed, stolen, altered, or used by an unauthorized individual. This playbook outlines steps to detect, assess, contain, and mitigate data loss events promptly and minimize their impact. The primary objective is to safeguard sensitive data, maintain stakeholder trust, and comply with data protection regulations. This document outlines three phases: Assessment, Response, and Post-Incident.\n\n## Phase 1: Assessment\n\nVerifying reported incidents and assessing their potential impact is critical. It involves gathering information, analyzing data, and making informed decisions.\n\n**Key Activities:**\n\n1.  **Incident Intake:** Document the initial report, including incident details and the reporter's information. *(Anyone observing a breach should immediately report it to <your help desk or IT service desk> per <your organization's Security Incident Response Process>)*\n2.  **Verification:** Confirm the incident's occurrence through multiple sources. Determine the legitimacy of the data breach (e.g., is it genuine? Is confidentiality breached? Where was it located?).\n3.  **Triage:** Prioritize incidents based on potential impact and urgency.\n4.  **Notify Leadership:** Notify leadership within your organization accordingly based on severity.\n5.  **Mobilize Incident Response Team:** Mobilize the cybersecurity incident response team to determine the scope of the data loss. Initial investigation includes:\n    * Determine whether data loss or data breach has occurred.\n    * Determine the preliminary business impact.\n    * Determine how the cyber incident was reported.\n    * Determine the initial number of affected assets across the organization.\n    * Identify the attack email or ingress point.\n    * Identify indicators of compromise.\n    * Examine additional reporting relating to affected assets (AV logs, system event logs, network monitoring logs).\n    * Research Threat Intelligence sources to gain further intelligence and support mitigation by others.\n    * Note any current action(s) being undertaken.\n6.  **Data Collection & Investigation:** Gather relevant data and preserve evidence. Initiate a formal investigation to determine the root cause and extent of compromise.\n7.  **Impact Assessment:** Evaluate the incident's impact on confidentiality, integrity, availability, reputation, and compliance.\n\n**Essential Communications during Assessment:**\n\n* **To Senior Management, Corporate Communication (After initial investigation and confirmation):** Confirmation of incident, extent, and high-level resolution plan.\n* **To Canadian Centre for Cybersecurity (CCCS), Local Law Enforcement, CyberAlberta (Recommended):** Notify CCCS for awareness and potential assistance. Report intentional data destruction to law enforcement. CyberAlberta may assist and warn other COI members.\n* **To Office of the Information Privacy Commissioner (OIPC) (If privacy breach suspected):** Communicate incident details, evidence of privacy impact, records and individuals potentially compromised.\n* **To Public (In response to multiple public concerns or media inquiries):** High-level messaging that service impacts are investigated. Remain reactive at this stage, avoid sharing undetermined information. Messaging approved by cybersecurity and leadership. Responding can help control the narrative.\n\n## Phase 2: Response\n\nThe main goal is to recover from the incident in the least amount of time possible.\n\n**Key Activities:**\n\n1.  **Engage Forensics Team:** If your organization has a forensics team, contact them immediately upon detecting a data breach.\n2.  **Isolate Affected Systems/Accounts:** Isolate all affected systems or accounts from the infrastructure (remove from network or apply strict access controls) to prevent further data exfiltration.\n3.  **Block Suspicious Traffic:** Implement rules to block detected suspicious traffic leaving the network.\n4.  **Review Impact & Identify Data:** Review the impact of the data breach based on data sensitivity. Identify any data impacted, including data-in-transit. Engage data owners and business to understand business impact.\n5.  **Contact External Platforms:** Initiate contacting administration of any external platform now hosting copies of breached data.\n6.  **Remote Wipe (if applicable):** Remotely erase any lost or stolen assets where possible.\n7.  **Interim Reporting:** Provide an interim incident report to service owners of affected system(s).\n8.  **Preserve Evidence:** Preserve any compromised assets or copies, if possible, for future analysis including forensic investigation.\n9.  **Develop Remediation Plan:** Incorporate technical and business analysis in developing a prioritized remediation plan, including a communication strategy.\n10. **Suspend Accounts (if malicious):** Suspend confirmed and suspected compromised accounts.\n11. **Quarantine & Contain (if malicious):** Reduce further malicious activity by quarantining affected systems (manually or automatically) and removing them from the network or applying access controls. Keep business data owners and stakeholders informed. Scope containment by searching for SHA-1 process name, executable file name, URL/IP of similar connections. Develop protection measures based on malicious code analysis.\n12. **Restore Systems:** Conduct restoration of any compromised systems from a trusted and tested backup. Prioritize recovery based on business impact analysis and criticality.\n13. **Re-image Affected Systems:** Re-image affected systems/devices. This includes re-installing standalone systems from a clean OS backup before updating with trusted data backups. Reset credentials of all compromised system(s) and users' accounts. Coordinate necessary patches or vulnerability remediation.\n14. **Restore Service & Monitor:** Once data/systems are restored/re-imaged, begin service restoration. Activities include: complete malware scanning, reintegrate previously compromised systems, restore corrupted/destroyed data, restore suspended services. Continue monitoring for IoCs. Confirm policy compliance.\n\n**Essential Stakeholder Communications during Response:**\n\n* **To Forensics Team, IT Support Teams, Leadership (After initial assessment & communication):** Notify Forensics to preserve evidence. IT support (server, storage, backup) to resolve encrypted files. Provide Leadership with a high-level resolution plan.\n* **To Leadership (Routinely):** Provide routine status updates based on impact and urgency.\n* **To Communications Team (After initial impact assessment):** They can support stakeholder, internal, and public communications. Ensure they are aware of high-level updates. Public communications materials/approach approved by cybersecurity and leadership.\n* **To Privacy Team (After privacy impacts discovered):** Notify to initiate their privacy breach response processes.\n* **To Legal Team (After initial impact assessed and suspected violations):** Notify about nature of impact, type of data, stakeholders. They may need to look at legal implications.\n* **Public Communications (Depending on severity):**\n    * **Communications Plan:** Outline overall approach for stakeholders, staff, public.\n    * **Key Messages:** Develop consistent key messages. Be transparent without sharing sensitive info. Approved by cybersecurity/leadership.\n    * **Social Media (for public inquiries):** Provide high-level updates. Reactive for minimal impact, proactive for larger incidents.\n    * **Media Statement/Response (for media inquiries):** Provide incident information.\n    * **Web Content / Direct Stakeholder Communications (for significant public impacts):** Inform stakeholders of incident and resolution steps. Use existing channels, provide multiple updates. Approved by cybersecurity/leadership.\n\n## Phase 3: Post-Incident\n\nA comprehensive post-mortem analysis should be conducted after resolving a data loss incident. It involves a detailed examination to identify strengths, weaknesses, and lessons learned, using incident data, logs, and documentation. Findings update the playbook and enhance security posture. Conducting lessons learned exercises helps implement further mitigation and corrective actions. Revising the plan based on these lessons ensures robust response and recovery. Lessons learned may also be shared with other organizations like CyberAlberta Community of Interest.\n\n**Key Activities:**\n\n1.  **Complete Root Cause Analysis:** Determine how the data loss occurred, possibly with the forensic team.\n2.  **Draft Post-Incident Report:** Include cause, impact, actions taken (successful or not), timings, type, location, effects on users/clients, activities by operations/providers/stakeholders to resume business, recommendations for improvements (people, process, technology), and review of staff welfare (working hours, overtime, expenses).\n3.  **Formal Lessons Identified Process:** Document lessons learned (best practices, new insights, strategies) to feedback into future preparation and enhance the playbook/procedures.\n4.  **Internal Communications:** Publish to inform and educate employees on data loss incidents and security awareness.\n5.  **External Communications (if appropriate):** Inline with communications strategy, provide advice to customers, engage with the market, inform the press. Provide key info without creating new vulnerabilities.\n6.  **Malware Reverse-Engineering (if applicable):** Reverse-engineer malware in a secure environment to understand mechanisms and functionality (e.g., in a sandbox). Classify malware by submitting to AV vendors.\n7.  **Update Playbook:** Use post-mortem findings to update the data loss playbook, refine procedures, and integrate new knowledge.\n\n**Essential Communications during Post-Incident Phase:**\n\n* **To Leadership (After incident resolved):** Post-incident report including root cause analysis, high-level incident summary (what, when, how resolved, repercussions), lessons learned, planned preventative measures.\n* **To Clients/Stakeholders/Public (After leadership informed, if sensible):** High-level information about the incident, resolution, and advice, aligned with previous messaging. Coordinated by Cybersecurity/Leadership or Communication team.\n\n(Note: Placeholders like <your help desk or IT service desk> from the original document have been kept to indicate customization points for your organization.)\n\n</s>"
  },
  {
    "text": "<s>[INST] <<SYS>>\nYou are a helpful cybersecurity assistant that generates detailed incident response playbooks based on established industry guides and best practices, such as the Debix Data Breach Incident Response Workbook.\n<</SYS>>\n\nPlease generate a comprehensive Data Breach Incident Response Workbook, including preparation, team building, checklists, and notification guidance, based on the Debix guide.\n[/INST] \n\n# Data Breach Incident Response Workbook (Based on Debix Guide)\n\n## Introduction\nThis workbook provides guidance and recommendations for planning a well-orchestrated response to a data compromise. Proactive planning can minimize the impact when a breach occurs. Key actions during a breach response include moving swiftly, following the plan, and meticulously documenting all events, people involved, and discoveries into a timeline for evidentiary use.\n\n## Phase 1: Preparing For A Data Breach\n\n* **Have a Response Plan:** The number one recommendation is to have a response plan in place. This plan should include written emergency contact lists, understanding of law enforcement agencies to contact, and notification timeframes (internal SLAs).\n* **Vendor Contracts:** Establish vendor contracts in advance for: mail-house for notification letters, call center (if in-house staff cannot handle a major breach), and pre-negotiated rates for consumer fraud protection. It's difficult to negotiate these during an emergency.\n* **Regular Team Meetings & Drills:** The incident response team should meet monthly to update contact information, discuss organizational changes, review incidents, and evaluate the response process. Practice responding to a data breach at least annually, preferably quarterly.\n* **Documentation to Maintain:** Keep copies of the written Incident Response Plan, Service and Operating Level Agreements, PCI Data Security standard document (if applicable), notification responsibilities for card associations (if relevant), complete record of software licensing, and current asset/hardware inventory.\n* **Top Management Involvement:** Concern and focus on data security must come from top management to ensure fiscal and personnel resources are budgeted. Include CEO, CFO, CPO, CIO, and General Counsel in the Internal Response Team and Plan from the outset. This integrates information security as a core value.\n* **Continuous Re-evaluation:** Re-evaluate security systems and policies on an ongoing basis to stay updated on technologies and criminal trends.\n\n### 1.1. Build A Strong Internal Response Team\nBuild a team with representation from:\n* Executive Management\n* Information Technology (IT)\n* Customer Service\n* Risk Management and Security\n* Compliance and Audit\n* Legal\n* Privacy\n* Public Relations\n\n**Key Roles:**\n* **Incident Lead:** Assign an Incident Lead (and a backup) to direct and manage the internal response team, act as liaison between management and the team, coordinate efforts, notify appropriate internal/external parties, create documentation/timeline, identify key tasks, and estimate costs. Typically from legal or a chief privacy officer.\n* **Executive Management:** Needs to be kept up-to-date by the Incident Lead.\n* **Communications (PR):** Involved early to decide on consumer notification. Must work with legal counsel on obligations and timeline for notification.\n* **Legal, Privacy, and Compliance:** Work with counsel on response requirements, consumer notification decisions, and what external organizations to contact (e.g., credit card associations, acquirers if card data is breached; clients if their information is lost).\n* **Operations (Security and IT):** Critical in identifying what information was compromised. **Recommendation:** Hire outside certified data forensics specialists for computer intrusions, as untrained internal teams might tamper with or corrupt evidence.\n* **Customer Service and Human Resources (HR):** Involved if employee (HR) or customer (Customer Service) notification is required. Prepare for high call volumes; consider a dedicated hotline and a consumer website where individuals can check if they were impacted and find protection instructions (include FAQs).\n\n**Team Contact List:**\n* Create and distribute an Incident Response Phone List, updated at least quarterly. Include role, name, work/cell/home numbers, and email for each person and their backup. *(Refer to Sample Incident Response Phone List template in the Debix workbook for structure)*.\n* Maintain an External Contact List (for forensics, police, FBI, Secret Service, media, business partners, vendors, FTC, card processors) updated quarterly. *(Refer to External Contact List Template in the Debix workbook)*.\n\n## Phase 2: Initial Response & Checklist (First Few Hours)\n\nWith a data breach, timing is everything. Document everything that happens and everything you discover into a timeline.\n\n* **Create/Activate Data Breach Incident Plan/Log:** (Use Data Breach Investigations Log - Chapter 6 of Debix Workbook)\n    * Date (and time) of report, Date/Time of discovery.\n    * Name of person reporting.\n    * Details of how breach was reported.\n    * Type of data breach: theft, illegal access, insiders, oversight.\n    * Identify how breach happened and describe what happened.\n    * Containment status: Did you contain it? How and when?\n    * What was implemented so it cannot happen again (time and date)?\n    * How many consumers are affected?\n    * What information was lost? (Be specific: Name, Address, SSN, DOB, Account Numbers, Email, Passwords, etc.)\n    * Keep a list of all external officials/individuals contacted.\n* **Identify Problem - Type of Incident:**\n    * Network/server breach\n    * Hardware loss, theft, or destruction\n    * Software loss, theft, or destruction\n    * Hacking/unauthorized third-party access\n    * Unauthorized websites publishing sensitive corporate info\n* **Identify Affected Business Rules/Processes**.\n* **Assign an Incident Number** (new or reactivate existing).\n* **Alert the Incident Lead**.\n* **Activate Incident Response Team**.\n* **Main Goal:** Maintain and restore business continuity.\n* **Team Actions:**\n    * Collect/review incident documentation and event reports.\n    * Verify facts.\n    * Help assign event severity.\n    * Alert appropriate external and internal contacts.\n* **Secure the Area & Record Information:** Gather names/contact info of everyone present, restrict area, note physical security controls.\n\n## Phase 3: Evidence Collection & Forensic Analysis\n\n* **Begin Collecting Evidence:** Use Data Breach Investigations Log (Chapter 6 of Debix Workbook).\n* **Maintain Chain of Evidence:** Record any and all modifications. Thoroughness over speed. Restrict information on a need-to-know basis.\n    * Where, when, and who discovered evidence?\n    * Who handled/examined evidence and when?\n    * Custody details: stored by, location, time submitted/released, released to.\n    * Record custody changes (how, when, shipping numbers).\n* **Protect Host Servers:** Consult certified data forensics agency to perform/assist investigation. Disconnect if compromised.\n* **Restore Host Servers:** Use appropriate monitoring.\n* **Maintain Data Integrity:** Maintain baselines of normal activity for comparison.\n* **Start Forensic Analysis:** How, what, why did this happen?\n    * Goal: Discover What, Where, When, Who, and How.\n* **Keep Detailed Logs:** Be consistent. Treat every incident as if it will lead to a court case (time/date entries, sign pages). Do not include confidential information unless necessary.\n* **Consult Legal Counsel:** At the beginning of an investigation.\n* **Develop and Record Hypothesis:** How does evidence support/contradict it? What did you do, what evidence found, how tested? Important interactions? Other ideas at the time?\n* **Evidence Storage:** Use tamper-resistant containers in limited access, secure storage. Originals to Legal, copy for company security. Record all access to storage. Create itemized inventory, verify with law enforcement if evidence is turned over (legal counsel present).\n\n## Phase 4: Containment\n*(Specific steps for systems where intrusion is suspected, before shutdown)*\n\n* Make a list of running processes on the system.\n* Check network interface status (promiscuous mode).\n* List all listening ports and active network connections (include owning processes if possible).\n* Perform as few operations as possible that access/modify file system before making a bit-for-bit copy.\n* **Preferred Process for Compromised Host:**\n    * Make two bit-for-bit copies of the compromised host's hard drive (one for restoration, one for forensics).\n    * Remove original hard drive and secure as evidence.\n    * Use one copy to aid creation of a new system disk (copy only known safe data); then erase the disk using a secure wipe utility.\n    * Use the second copy for forensics.\n* Use only executables with verified integrity (avoid trojans, modified binaries). Create an Incident Response CD-ROM with appropriate binaries/documentation, or use original installation media. Be aware utilities might rely on shared libraries that could be modified.\n\n## Phase 5: Reporting and Notification\n\n* **Begin Reporting Process:** Limit communication, use discretion. Be especially careful with breach victims and media.\n* **Notify Law Enforcement:** At discretion of upper management. Consider incident severity, scope, lawyer's recommendations. If harm possible, contact local police immediately. Contact FBI/Secret Service if local police unfamiliar. Mail theft: U.S. Postal Inspection Service.\n* **Create Executive-Level Report (1-2 pages):** High-level incident description/scope, company impact, actions taken, recommendations.\n* **Create Technical Report:** Detailed event/investigation info, all conclusions. Data must reference collected evidence and be verifiable.\n\n### 5.1. Notifying Customers and Affected Businesses\n* Complex issue due to varying state laws. This is an overview, not inclusive of all issues. State laws differ on PII definition, who to notify (Agencies, Law Enforcement, Credit Reporting Agencies), timing, letter content.\n* **When to Notify:** Not every incident requires it. Depends on assessment of severity, scope, nature of data. If notifying for one state, notify all affected individuals, including overseas (recommended).\n* **Notifying Individuals:** Early notification allows them to mitigate misuse. Consider: nature of compromise, type of info, likelihood of misuse, potential damage. Consult legal counsel; most states require it (some within 30 days). Some states require AG notification.\n* **FTC Recommendations for Notification:**\n    * Consult law enforcement on timing (not to impede investigation).\n    * Designate an internal contact person for information release (latest info, official response, how individuals should respond).\n    * Consider letters, websites, toll-free numbers for communication.\n    * Clearly describe what's known: how it happened, info taken, how thieves used it, company actions, appropriate responses for compromised info type. Explain how to reach contact person.\n    * Provide law enforcement contact/case number for victims. Victims should request police report for creditors.\n    * Encourage victims to file FTC complaint (www.ftc.gov/idtheft or 1-877-ID-THEFT).\n* **Possible Exemptions to Notifying (NOT LEGAL ADVICE):**\n    * Data was 128-bit encrypted (state laws specific, e.g., California).\n    * No evidence/reason to believe data misused (some state laws).\n    * Information already publicly available (some states).\n    * Reasonable doubt information accessed/used after breach stopped (some states).\n    * No risk to organization (lost business, lawsuits).\n* **Notification Hints and Tips:**\n    * Well-organized, direct, concise. Clear who it's from, action required.\n    * Print on agency letterhead, high-quality paper, security envelope.\n    * Expect 5-10% call rate, calls 5-15 mins. Minimize call center costs by sending letters in waves.\n    * Put end date on free offers in letter, be firm. Mail-in postmarked by deadline (allow 10 days for receipt). Plan for those claiming non-receipt.\n* **Providing Protection for Breach Victims:**\n    * Javelin study (2008): Offering fraud protection significantly improves customer approval. Victims prefer prevention (56%) over detection (20%) or resolution (19%).\n    * Research available fraud protection services (prevention, detection, resolution). Select convenient/easy solution for victims, understanding impact on new account fraud prevention.\n    * Offer assistance proactively; don't make them request it.\n    * Avoiding common mistakes: Not offering protection initially often leads to negative press, lawsuits, then offering it later (cost of second notification).\n    * Notification letter: Be open, honest, direct. Accept responsibility, explain actions. Include website for more info, toll-free line with hours.\n* **Notifying Affected Businesses:**\n    * If account access info (credit card/bank numbers) stolen from a company not maintaining accounts, notify institution that does (e.g., banks, credit issuers) for fraud monitoring.\n    * If personal info collected/stored on behalf of other businesses, notify them too.\n    * If info improperly posted on company website, remove immediately. Contact search engines to prevent archiving of mistakenly posted personal info.\n\n## Phase 6: Post-Incident Review (Lessons Learned)\n*(This overlaps with CyberAlberta's Post-Incident Phase, but Debix emphasizes documentation templates)*\n\n* Use the "Data Breach Investigations Log" and other worksheets from the Debix workbook to document events, actions, and timelines comprehensively. This helps with court cases and future prevention.\n* Continuously update contact lists and documentation.\n\n*(Note: This playbook is based on a workbook with many templates. Key actions and checklist items have been extracted. Placeholder tables for contact lists, incident logs, etc., from the original are noted but not fully reproduced here for brevity, assuming the organization would use the Debix workbook's actual forms.)*\n\n</s>"
  }
]
